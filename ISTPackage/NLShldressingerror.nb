(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    274661,       7169]
NotebookOptionsPosition[    269467,       7057]
NotebookOutlinePosition[    269879,       7074]
CellTagsIndexPosition[    269836,       7071]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Copyright", " ", "2013", " ", "Thomas", " ", "Trogdon"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "software", " ", "is", " ", "distributed", " ", "under", " ", 
    "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", "General", 
    " ", "Public", " ", "License"}], " ", "*)"}]}]], "Input",ExpressionUUID->\
"44ac4397-fe58-4aea-93eb-f060a41b809a"],

Cell[CellGroupData[{

Cell["Documentation", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5463622250573997`*^9, 
  3.5463622273694*^9}},ExpressionUUID->"8931ef81-d18b-4dca-9d3a-67580819adfe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<RiemannHilbert`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HillNLS", "::", "usage"}], "=", 
   "\"\<HillNLS[q,n] gives the eigenvalues of the modified Zakharov-Shabat \
scattering (including continuous spectrum) problem with n Fourier modes using \
Hill's method.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocatePolesNLS", "::", "usage"}], "=", 
   "\"\<LocatePoles[q,n] gives the true eigenvalues of the modified \
Zakharov-Shabat scattering problem.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NLS", "::", "usage"}], "=", 
   "\"\<NLS[i][x,t] = {out,\[CapitalPhi],rhp1,rhp2,timestring} where out is \
the solution of NLS, \[CapitalPhi] is the solution of the Riemann-Hilbert \
problem, rhp1 and rhp2 are the Riemann-Hilbert problems and timestring is the \
string of computation times.  This is done using the deformation in Region i.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NLSAuto", "::", "usage"}], "=", 
  "\"\<NLSAuto[x,t] returns the solution of the NLS equation with deformation \
selected automagically.  Many things must be initialized.  Sample code:\n\n\t\
q[x_]:=.1 Exp[-x^2+I x];\[IndentingNewLine]Defocusing[];\n\t\
H=ScatteringMatrixFiniteNLS[q,50,6];\[IndentingNewLine]aa//Clear;bb//Clear;\
\[IndentingNewLine]aa[k_]:=aa[k]=H[k][[1,1]];\[IndentingNewLine]bb[k_]:=bb[k]=\
H[k][[2,1]];\n\t\
SetParams[.6,.1,10.^(-9),15,30];\[IndentingNewLine]h[k_]:=3/(1+Abs[k/2+1/3.2]^\
8);\[IndentingNewLine]Setrsamp[h];\[IndentingNewLine]Settimeflag[False];\
\[IndentingNewLine]\[Nu]=Getnu[];\[IndentingNewLine]\[Rho][k_]:=bb[k]/aa[k];\n\
\tup=I(\[Nu]+.0001);m=40;el=8;\[IndentingNewLine]f={Fun[\[Rho],Line[{-el,0}-\
up],m],Fun[\[Rho],Line[{0,el}-up],m],Fun[\[Rho],Line[{el,0}+up],m],Fun[\[Rho],\
Line[{0,-el}+up],m]};\n\n\t\
up=I(\[Nu]+.0001);m=40;el=8;\[IndentingNewLine]f={Fun[\[Rho],Line[{-el,0}-up],\
m],Fun[\[Rho],Line[{0,el}-up],m],Fun[\[Rho],Line[{el,0}+up],m],Fun[\[Rho],\
Line[{0,-el}+up],m]};\n\
SetScatteringData[aa,bb,m\[Rho],LocatePoles[q,40]]\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Focusing", "::", "usage"}], "=", 
   "\"\<Focusing[], switch to focusing NLS\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Defocusing", "::", "usage"}], "=", 
   "\"\<Defocusing[], switch to focusing NLS\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetScatteringData", "::", "usage"}], "=", 
   "\"\<SetScatteringData[a,b,\[Rho],poles] or \
SetScatteringData[a,b,\[Rho],poles,normingConstants] sets the scattering data \
for the NLS equation\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetParams", "::", "usage"}], "=", 
   "\"\<SetParams[\[Nu],rad,globalTol,smallN,bigN] sets the parameters for \
the rest of the code:\n\t\[Nu]: half of width of strip of analyticity\n\trad: \
radius of soliton contours\n\tglobalTol: contour truncation tolerance\n\t\
smallN: small number of collocation points\n\tbigN: big number of collocation \
points\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringData", "::", "usage"}], "=", 
   "\"\<GetScatteringData[] = {\[Rho],poles,normingConstants}\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScatteringMatrixFiniteNLS", "::", "usage"}], "=", 
   "\"\<ScatteringMatrixFiniteNLS[q,n,L] returns a function f[w] that \
produces an approximation of the scattering matrix at w. The parameter n \
indicates the number of collocation points and L sets the problem on [-L,L]\n\
Sample code:\n\tq[x_]:=.1 Exp[-x^2+I x];\[IndentingNewLine]Defocusing[];\n\t\
H=ScatteringMatrixFiniteNLS[q,50,6];\[IndentingNewLine]aa//Clear;bb//Clear;\
\[IndentingNewLine]aa[k_]:=aa[k]=H[k][[1,1]];\[IndentingNewLine]bb[k_]:=bb[k]=\
H[k][[2,1]];\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScatteringMatrixBFiniteNLS", "::", "usage"}], "=", 
   "\"\<ScatteringMatrixBFiniteNLS[g0,g1,n,L] returns a function f[w] that \
produces an approximation of the scattering matrix at w. The parameter n \
indicates the number of collocation points and L sets the problem on [-L,L]\n\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Getnu", "::", "usage"}], "=", "\"\<Getnu[] returns \[Nu]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setrsamp", "::", "usage"}], "=", 
   "\"\<Setrsamp[h] sets a function that should be chosen so that that \
|\[Rho]| < h\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timestring", "::", "usage"}], "=", 
   "\"\<A string updated by NLS[i][x,t]\n(x,t) 1) Construct: --time to \
construct rhp1-- 1) Solve: --time to solve rhp1-- 2) Construct: --time to \
construct rhp2-- 2) Solve: --time to solve rhp2--\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Settimeflag", "::", "usage"}], "=", 
   "\"\<Settimeflag[bool] bool = True forces timestring to be printed each \
time NLS[i][x,t] is called\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"startift", ";"}], "\[IndentingNewLine]", 
 RowBox[{"domainOutput", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ift", ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalPhi]t", ";"}], "\[IndentingNewLine]", 
 RowBox[{"dom", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Jadapt", ";", "J", ";", "Jsamp", ";"}], "\[IndentingNewLine]", 
 RowBox[{"L", ";", "U", ";", "DD", ";", "G2", ";"}], "\[IndentingNewLine]", 
 RowBox[{"rhp1", ";", "rhp2", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.503865094224187*^9, 3.5038651020296*^9}, {
   3.503927907403412*^9, 3.503927909713172*^9}, {3.5463622424474*^9, 
   3.5463622642414*^9}, {3.5463626582194*^9, 3.5463626735304003`*^9}, {
   3.5463627171584*^9, 3.5463627549664*^9}, {3.5463630470550003`*^9, 
   3.546363053007*^9}, {3.5463636741546*^9, 3.5463636807546*^9}, {
   3.5463641965566*^9, 3.5463641987186003`*^9}, {3.5463649081344*^9, 
   3.5463649091744003`*^9}, {3.5463651229344*^9, 3.5463651320044003`*^9}, {
   3.5463652879944*^9, 3.5463652884544*^9}, {3.5463658662204*^9, 
   3.5463658844244003`*^9}, {3.5463661544224*^9, 3.5463661639164*^9}, {
   3.5463662109983997`*^9, 3.5463662153784*^9}, {3.5463675756984*^9, 
   3.5463675807684*^9}, {3.5463676634723997`*^9, 3.5463676657024*^9}, {
   3.546389444761112*^9, 3.546389456597519*^9}, {3.546391697049466*^9, 
   3.546391698452414*^9}, {3.5464015603071537`*^9, 3.546401590871516*^9}, {
   3.546434403958077*^9, 3.5464344147152987`*^9}, {3.563910225793398*^9, 
   3.563910227918174*^9}, {3.5656137687682*^9, 3.5656137697542*^9}, {
   3.5656139003392*^9, 3.5656139288342*^9}, {3.5656151920592003`*^9, 
   3.5656151970192003`*^9}, {3.5656156395151997`*^9, 3.5656156445502*^9}, {
   3.5656157463582*^9, 3.5656157484662*^9}, {3.5656159228382*^9, 
   3.5656159263012*^9}, {3.5656174040372*^9, 3.5656174070202*^9}, {
   3.5656177920601997`*^9, 3.5656177959472*^9}, {3.5656190027962*^9, 
   3.5656190070972*^9}, {3.5656291442992*^9, 3.5656291485092*^9}, {
   3.5656305555502*^9, 3.5656306099792*^9}, {3.5656333098972*^9, 
   3.5656333107482*^9}, {3.5656339377812*^9, 3.5656339379602003`*^9}, {
   3.5656345203662*^9, 3.5656345212532*^9}, {3.5656346861972*^9, 
   3.5656346887962*^9}, {3.5656352908831997`*^9, 3.5656352937382*^9}, {
   3.5656380208282003`*^9, 3.5656380229882*^9}, {3.5656626102882*^9, 
   3.5656626208182*^9}, {3.5656646656742*^9, 3.5656646676742*^9}, 
   3.5656647127002*^9, {3.5657063129751997`*^9, 3.5657063150542*^9}, {
   3.5657085673072*^9, 3.5657085693552*^9}, {3.5657106763982*^9, 
   3.5657106766582003`*^9}, {3.5657108974332*^9, 3.5657109289282*^9}, {
   3.5657112059252*^9, 3.5657112089561996`*^9}, {3.5657119385382*^9, 
   3.5657119412162*^9}, {3.5657191417841997`*^9, 3.5657191465492*^9}, {
   3.5657193088412*^9, 3.5657193090162*^9}, {3.5657213945302*^9, 
   3.5657213956292*^9}, {3.5657214903452*^9, 3.5657215001092*^9}, {
   3.5657276459312*^9, 3.5657276473922*^9}, {3.5657280965452003`*^9, 
   3.5657280993452*^9}, {3.5657304429572*^9, 3.5657304456022*^9}, {
   3.5657305464231997`*^9, 3.5657305507342*^9}, {3.565742611453149*^9, 
   3.5657427171054707`*^9}, {3.56574277865187*^9, 3.565742869146963*^9}, {
   3.565742980436193*^9, 3.5657431898856077`*^9}, {3.5657432503045673`*^9, 
   3.565743264006617*^9}, {3.56574333818435*^9, 3.565743342266161*^9}, {
   3.565743416325479*^9, 3.5657434710920467`*^9}, {3.5657435014216003`*^9, 
   3.5657435144636393`*^9}, {3.565743583840477*^9, 3.5657437287947283`*^9}, {
   3.5657437682505836`*^9, 3.565743808785096*^9}, {3.565743854229642*^9, 
   3.565743981397606*^9}, {3.5657440541607656`*^9, 3.5657441106114883`*^9}, {
   3.565744147396241*^9, 3.565744148127984*^9}, {3.56574418639472*^9, 
   3.565744267538278*^9}, {3.565744472266567*^9, 3.565744539531228*^9}, {
   3.565744640232654*^9, 3.5657447146254187`*^9}, {3.5657447532043657`*^9, 
   3.5657447701282787`*^9}, {3.565744803503544*^9, 3.5657448370120697`*^9}, {
   3.565744873278673*^9, 3.5657449429227867`*^9}, {3.565744976404983*^9, 
   3.5657449773873863`*^9}, {3.565745127535184*^9, 3.565745150433978*^9}, {
   3.565745801755686*^9, 3.565745839129191*^9}, {3.5657458760558653`*^9, 
   3.565745905863186*^9}, {3.565745966784422*^9, 3.5657460022073174`*^9}, {
   3.565746048799855*^9, 3.5657460682812347`*^9}, {3.5657461057046137`*^9, 
   3.5657461388764*^9}, {3.565746178691865*^9, 3.565746183667274*^9}, {
   3.5657535451222*^9, 3.5657535462162*^9}, {3.565753855140954*^9, 
   3.565753855840127*^9}, {3.5657539853194313`*^9, 3.5657539870126247`*^9}, {
   3.565754408445376*^9, 3.565754408749222*^9}, {3.5657550866242857`*^9, 
   3.5657550884680643`*^9}, {3.565755149738063*^9, 3.565755152755093*^9}, {
   3.5657552771517467`*^9, 3.565755278189406*^9}, {3.5657607684613123`*^9, 
   3.565760770041016*^9}, {3.565802574600819*^9, 3.565802579155362*^9}, {
   3.568128176969741*^9, 3.568128177188424*^9}, {3.568764568236958*^9, 
   3.568764568499837*^9}, {3.5687789570461273`*^9, 3.568778959651313*^9}, {
   3.568778997645636*^9, 3.5687789978647327`*^9}, {3.5687791469567947`*^9, 
   3.568779148611024*^9}, {3.7970140031009336`*^9, 3.797014005661111*^9}, {
   3.7983308850654087`*^9, 3.798330888635171*^9}, {3.7983318871335573`*^9, 
   3.798331894064559*^9}, {3.8213818882790318`*^9, 3.8213818886580143`*^9}, {
   3.824322923212423*^9, 
   3.8243229240023937`*^9}},ExpressionUUID->"a6e7b6bd-3601-4fa9-985f-\
a9141df366d0"],

Cell[BoxData["\<\"NLSAuto[x,t] returns the solution of the NLS equation with \
deformation selected automagically.  Many things must be initialized.  Sample \
code:\\n\\n\\tq[x_]:=.1 Exp[-x^2+I \
x];\[IndentingNewLine]Defocusing[];\\n\\tH=ScatteringMatrixFiniteNLS[q,50,6];\
\[IndentingNewLine]aa//Clear;bb//Clear;\[IndentingNewLine]aa[k_]:=aa[k]=H[k][[\
1,1]];\[IndentingNewLine]bb[k_]:=bb[k]=H[k][[2,1]];\\n\\tSetParams[.6,.1,10.^(\
-9),15,30];\[IndentingNewLine]h[k_]:=3/(1+Abs[k/2+1/3.2]^8);\
\[IndentingNewLine]Setrsamp[h];\[IndentingNewLine]Settimeflag[False];\
\[IndentingNewLine]\[Nu]=Getnu[];\[IndentingNewLine]\[Rho][k_]:=bb[k]/aa[k];\\\
n\\tup=I(\[Nu]+.0001);m=40;el=8;\[IndentingNewLine]f={Fun[\[Rho],Line[{-el,0}-\
up],m],Fun[\[Rho],Line[{0,el}-up],m],Fun[\[Rho],Line[{el,0}+up],m],Fun[\[Rho],\
Line[{0,-el}+up],m]};\\n\\n\\tup=I(\[Nu]+.0001);m=40;el=8;\[IndentingNewLine]\
f={Fun[\[Rho],Line[{-el,0}-up],m],Fun[\[Rho],Line[{0,el}-up],m],Fun[\[Rho],\
Line[{el,0}+up],m],Fun[\[Rho],Line[{0,-el}+up],m]};\\nSetScatteringData[aa,bb,\
m\[Rho],LocatePoles[q,40]]\"\>"], "Output",
 CellChangeTimes->{
  3.796497253003475*^9},ExpressionUUID->"461303ec-3d51-4221-904b-\
01ac16eba5c0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.546363064814*^9, 3.546363067493*^9}, {
  3.565745327189906*^9, 
  3.5657453277187843`*^9}},ExpressionUUID->"01de002d-1954-4c3e-935d-\
772c05829c6e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Focusing", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"\[Lambda]", "=", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Defocusing", "[", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"-", "1"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SetScatteringData", "[", 
      RowBox[{"aa_", ",", "bb_", ",", "rr_", ",", "ma_", ",", "mc_"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"r", "[", "k_", "]"}], ":=", 
         RowBox[{"rr", "[", "k", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", "ma"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "k_", "]"}], ":=", 
         RowBox[{"1", "+", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"r", "[", "k", "]"}], 
           RowBox[{"cc", "[", 
            RowBox[{"r", "[", 
             RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", 
          RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "k_List", "]"}], ":=", 
         RowBox[{"\[Tau]", "/@", "k"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dom", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Truncate", "[", "globalTol", "]"}], "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "el"}], ",", "el"}], "}"}], "]"}], ",", "100"}], 
            "}"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "dom", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", "mc"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetScatteringData", "[", 
     RowBox[{
     "g_", ",", "G_", ",", "A1_", ",", "C1_", ",", "A2_", ",", "C2_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gam", "=", "g"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gam", "=", "G"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", "A1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", "C1"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SetScatteringData", "[", 
      RowBox[{"aa_", ",", "bb_", ",", "rr_", ",", "ma_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", "k_", "]"}], ":=", 
          RowBox[{"rr", "[", "k", "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", "ma"}], ";", "\[IndentingNewLine]", 
        RowBox[{"a1", "=", "aa"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b1", "=", "bb"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Tau]", "[", "k_", "]"}], ":=", 
           RowBox[{"1", "+", 
            RowBox[{"\[Lambda]", " ", 
             RowBox[{"r", "[", "k", "]"}], 
             RowBox[{"cc", "[", 
              RowBox[{"r", "[", 
               RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Tau]", "[", 
            RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", "1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Tau]", "[", "k_List", "]"}], ":=", 
           RowBox[{"\[Tau]", "/@", "k"}]}], ";", 
          RowBox[{
          "need", " ", "this", " ", "for", " ", "poles", " ", "but", " ", 
           "tao", " ", "is", " ", "used", " ", "for", " ", "other", " ", 
           "names", " ", "now"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ma", "\[NotEqual]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"dom", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Truncate", "[", "globalTol", "]"}], "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Log", "[", 
                   RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
                 RowBox[{"Line", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "el"}], ",", "el"}], "}"}], "]"}], ",", 
                 "100"}], "}"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", "dom", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"df1", "=", 
            RowBox[{"f1", "'"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"da", "[", "k_", "]"}], ":=", 
            RowBox[{"Cauchy", "[", 
             RowBox[{"df1", ",", "k"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", 
              RowBox[{"Length", "[", "ma", "]"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"c", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Quiet", "[", 
                    RowBox[{"bb", "[", 
                    RowBox[{"ma", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "/", 
                   RowBox[{"da", "[", 
                    RowBox[{"ma", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
               ";"}]}], 
            RowBox[{"(*", 
             RowBox[{"compute", " ", "norming", " ", "constants"}], "*)"}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetParams", "[", 
    RowBox[{
    "nu_", ",", "rad1_", ",", "tol_", ",", "sN_", ",", "bN_", ",", 
     "length_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Nu]", "=", "nu"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "parameter", " ", "for", " ", "width", " ", "of", " ", "strip", " ", 
        "of", " ", "analyticity"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rad", "=", "rad1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"globalTol", "=", "tol"}], ";", "\[IndentingNewLine]", 
      RowBox[{"smallN", "=", "sN"}], ";", "\[IndentingNewLine]", 
      RowBox[{"bigN", "=", "bN"}], ";", "\[IndentingNewLine]", 
      RowBox[{"el", "=", "length"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetScatteringData", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "a", ",", "c"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Getnu", "[", "]"}], ":=", "\[Nu]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Setrsamp", "[", "h_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"rsamp", "=", "h"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Settimeflag", "[", "h_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"timeflag", "=", "h"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetN", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"bigN", "=", 
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"smallN", "=", 
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expconst", "=", "1"}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "having", " ", "this", " ", "large", " ", "solves", " ", "the", " ", 
     "bug"}], ",", " ", 
    RowBox[{
    "looks", " ", "like", " ", "invertion", " ", "is", " ", "the", " ", 
     "reason"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"bigN", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smallN", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"el", "=", "30"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5463630695*^9, 3.546363080922*^9}, {3.546363115111*^9, 
   3.546363141222*^9}, {3.5463634376070004`*^9, 3.546363492512*^9}, {
   3.5463635258719997`*^9, 3.546363635209*^9}, {3.5463659693424*^9, 
   3.5463659740664*^9}, {3.5463660119104*^9, 3.5463661504323997`*^9}, {
   3.5463664883764*^9, 3.5463664944384003`*^9}, {3.5463666192464*^9, 
   3.5463666459524*^9}, {3.5463667113484*^9, 3.5463667373324003`*^9}, {
   3.5463676399364*^9, 3.5463676562564*^9}, {3.546390936499014*^9, 
   3.546390947510488*^9}, {3.546401541105667*^9, 3.5464015544196997`*^9}, {
   3.546434422083152*^9, 3.546434437782632*^9}, {3.563910175270574*^9, 
   3.563910220797307*^9}, {3.564799718336*^9, 3.564799720823*^9}, {
   3.5649679651156*^9, 3.5649679782296*^9}, {3.5655714809302*^9, 
   3.5655714994402*^9}, {3.5655715372522*^9, 3.5655715645132*^9}, {
   3.5656148581191998`*^9, 3.5656148586572*^9}, {3.5656173795022*^9, 
   3.5656173983492002`*^9}, {3.5656200626132*^9, 3.5656200714432*^9}, {
   3.5656203941162*^9, 3.5656204067612*^9}, {3.5656338952332*^9, 
   3.5656339009142*^9}, {3.5656343322771997`*^9, 3.5656343385042*^9}, {
   3.5657105818142*^9, 3.5657105820962*^9}, {3.5657106368512*^9, 
   3.5657106371591997`*^9}, {3.5657106923602*^9, 3.5657107507892*^9}, 
   3.5657108510002003`*^9, {3.5657130676252003`*^9, 3.5657130795922003`*^9}, {
   3.5657280484491997`*^9, 3.5657280561782*^9}, {3.5657313869382*^9, 
   3.5657314205002003`*^9}, {3.565744033573463*^9, 3.565744042518571*^9}, {
   3.565745333305562*^9, 3.565745362905344*^9}, {3.5657454278631887`*^9, 
   3.565745444786531*^9}, {3.5657455096709547`*^9, 3.5657455425153027`*^9}, {
   3.565746618412477*^9, 3.565746650258099*^9}, {3.565753896592372*^9, 
   3.56575390058217*^9}, {3.565753960980502*^9, 3.5657539672129097`*^9}, {
   3.565754087442314*^9, 3.565754191303976*^9}, {3.565754253265995*^9, 
   3.565754273708042*^9}, {3.565754484213047*^9, 3.5657544921511374`*^9}, {
   3.565755271816646*^9, 3.565755314332326*^9}, {3.568778838468502*^9, 
   3.568778844504279*^9}, {3.6369966981721087`*^9, 3.636996717030632*^9}, {
   3.636996851466588*^9, 3.636996865624813*^9}, {3.702227422198697*^9, 
   3.702227429756291*^9}, {3.702227463757053*^9, 3.7022274669956636`*^9}, {
   3.702227501060815*^9, 3.7022275121174116`*^9}, {3.7965150662971053`*^9, 
   3.796515159187869*^9}, 3.796519086752968*^9, 3.7970156968285294`*^9, {
   3.798331490873618*^9, 3.7983315286779137`*^9}, {3.7983346457966585`*^9, 
   3.798334647250079*^9}, {3.8206893090339556`*^9, 3.8206893123368425`*^9}, {
   3.820701194883263*^9, 3.8207011979268527`*^9}, {3.821380444215928*^9, 
   3.821380470031316*^9}, {3.823194648997697*^9, 3.8231946782765064`*^9}, {
   3.8231948346227503`*^9, 3.8231948374544315`*^9}, {3.823194906101368*^9, 
   3.8231949142884636`*^9}, {3.823194983527251*^9, 3.8231949872787743`*^9}, {
   3.823212314507439*^9, 3.823212385120214*^9}, {3.8243050586212225`*^9, 
   3.824305081008525*^9}, {3.824305409985962*^9, 3.8243054216591105`*^9}, {
   3.8243077126536517`*^9, 3.8243077320193243`*^9}, {3.82432204917902*^9, 
   3.8243220677210855`*^9}, {3.824344833533346*^9, 3.8243448336987247`*^9}, {
   3.824345416510809*^9, 3.824345449019938*^9}, {3.8244158049604783`*^9, 
   3.8244158128087363`*^9}, {3.824417709083297*^9, 3.824417709770692*^9}, {
   3.825523993337383*^9, 3.8255240676591034`*^9}, 
   3.8255242451843586`*^9},ExpressionUUID->"96f36c45-5d8a-4e1c-8c5b-\
cd65f33b89f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other Functions", "Section",
 CellChangeTimes->{{3.5463623180694*^9, 3.5463623214114*^9}, {
   3.5657108715811996`*^9, 3.5657108824351997`*^9}, 
   3.568127509238703*^9},ExpressionUUID->"2e13379f-2867-4035-abed-\
dbe0815ed025"],

Cell[CellGroupData[{

Cell["Some Functions", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.5408983275643997`*^9, 
  3.5408983375383997`*^9}},ExpressionUUID->"139cb498-2fbf-4518-ba09-\
c46f82d0867a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "a1", " ", "is", " ", "aa", " ", "and", " ", "b1", " ", "is", " ", "bb"}], 
   ",", " ", 
   RowBox[{
   "a", " ", "is", " ", "used", " ", "for", " ", "ma", " ", "so", " ", "dont",
     " ", "want", " ", "to", " ", "change"}], ",", " ", 
   RowBox[{
   "be", " ", "careful", " ", "6.13", " ", "6.14", " ", "in", " ", 
    "fokas2005", " ", "has", " ", "lambda", " ", "differently"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.796515168567912*^9, 3.7965151907187257`*^9}, {
   3.7965157466954803`*^9, 3.7965157838000555`*^9}, 
   3.7983061095864086`*^9},ExpressionUUID->"834a6670-25e9-4883-b422-\
d9dcf7e28f8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"delta0", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "k", "]"}], "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a1", "[", 
         RowBox[{"-", 
          RowBox[{"Conjugate", "[", "k", "]"}]}], "]"}], "]"}]}], "+", 
      RowBox[{"\[Lambda]", "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b1", "[", 
         RowBox[{"-", 
          RowBox[{"Conjugate", "[", "k", "]"}]}], "]"}], "]"}], "*", 
       RowBox[{"b1", "[", "k", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gam", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{"b1", "[", "k", "]"}], "/", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"a1", "[", 
        RowBox[{"Conjugate", "[", "k", "]"}], "]"}], "]"}]}]}], ";", 
    RowBox[{
     RowBox[{"d", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "k", "]"}], "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"A1", "[", 
         RowBox[{"Conjugate", "[", "k", "]"}], "]"}], "]"}]}], "+", 
      RowBox[{"\[Lambda]", "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"B1", "[", 
         RowBox[{"Conjugate", "[", "k", "]"}], "]"}], "]"}], "*", 
       RowBox[{"b1", "[", "k", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Gam", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "\[Lambda]"}], ")"}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"B1", "[", 
          RowBox[{"Conjugate", "[", "k", "]"}], "]"}], "]"}], "/", 
        RowBox[{"a1", "[", "k", "]"}]}], "/", 
       RowBox[{"d", "[", "k", "]"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{"homo", " ", "neumann"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"delta1", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "k", "]"}], "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a1", "[", 
         RowBox[{"-", 
          RowBox[{"Conjugate", "[", "k", "]"}]}], "]"}], "]"}]}], "-", 
      RowBox[{"\[Lambda]", "*", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b1", "[", 
         RowBox[{"-", 
          RowBox[{"Conjugate", "[", "k", "]"}]}], "]"}], "]"}], "*", 
       RowBox[{"b1", "[", "k", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gam", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{"b1", "[", "k", "]"}], "/", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"a1", "[", 
        RowBox[{"Conjugate", "[", "k", "]"}], "]"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Gam", "[", "k_", "]"}], ":=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"-", "\[Lambda]"}], ")"}]}], "*", 
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"b1", "[", 
          RowBox[{"-", 
           RowBox[{"Conjugate", "[", "k", "]"}]}], "]"}], "]"}], "/", 
        RowBox[{"a1", "[", "k", "]"}]}], "/", 
       RowBox[{"delta1", "[", "k", "]"}]}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"2", " ", "I", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "t", " ", 
         SuperscriptBox["z", "2"]}], "+", 
        RowBox[{"x", " ", "z"}]}], ")"}]}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"G1", "[", 
        RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", GridBox[{
          {"1", "0"},
          {
           RowBox[{
            RowBox[{"Gam", "[", "z", "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
         }], ")"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G1", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Gam", "[", "z", "]"}]}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G1", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"G3", "[", 
        RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{"\[Lambda]", "*", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"Gam", "[", 
              RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
          {"0", "1"}
         }], ")"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G3", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{
          RowBox[{"-", "\[Lambda]"}], "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"Gam", "[", 
            RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
        {"0", "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G3", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"G4", "[", 
        RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{"Inverse", "[", 
       RowBox[{"(", GridBox[{
          {"1", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"gam", "[", "z", "]"}]}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
          {
           RowBox[{
            RowBox[{"-", "\[Lambda]"}], "*", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"gam", "[", "z", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], 
           RowBox[{"1", "+", 
            RowBox[{"\[Lambda]", "*", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"gam", "[", "z", "]"}], "]"}], "^", "2"}]}]}]}
         }], ")"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G4", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"1", "+", 
          RowBox[{"\[Lambda]", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"gam", "[", 
             RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
           RowBox[{"gam", "[", "z", "]"}]}]}], 
         RowBox[{
          RowBox[{"gam", "[", "z", "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
        {
         RowBox[{"\[Lambda]", "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"gam", "[", 
            RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G4", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"G2", "[", 
        RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"G3", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"G4", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}], ".", 
       RowBox[{
        RowBox[{"G1", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}]}], ";"}], "  ", 
    RowBox[{"(*", "wrong", "*)"}], "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"G2", "[", 
        RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"G1", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], ".", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"G4", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}], ".", 
       RowBox[{
        RowBox[{"G3", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}]}], ";"}], "  ", 
    RowBox[{"(*", "mine", "*)"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G2", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}]]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"Gam", "[", 
                RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
             RowBox[{"gam", "[", "z", "]"}]}], ")"}]}]},
         {
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"Conjugate", "[", 
               RowBox[{"gam", "[", 
                RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
             RowBox[{"Gam", "[", "z", "]"}]}], ")"}]}], 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"Conjugate", "[", 
                RowBox[{"Gam", "[", 
                 RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
              RowBox[{"gam", "[", "z", "]"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"Conjugate", "[", 
                RowBox[{"gam", "[", 
                 RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
              RowBox[{"Gam", "[", "z", "]"}]}], ")"}]}]}]}
        },
        GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}}], "\[NoBreak]", ")"}],
      Function[BoxForm`e$, 
       MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G2", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Gamsamp", "[", "z_", "]"}], ":=", 
     RowBox[{"rsamp", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gamsamp", "[", "z_", "]"}], ":=", 
     RowBox[{"rsamp", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G1samp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"Inverse", "[", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {
          RowBox[{
           RowBox[{"Gamsamp", "[", "z", "]"}], "*", 
           RowBox[{"Abs", "[", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}], 
            "]"}]}], "1"}
        }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G1samp", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G3samp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"Inverse", "[", 
      RowBox[{"(", GridBox[{
         {"1", 
          RowBox[{"\[Lambda]", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"Gamsamp", "[", 
             RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
           RowBox[{"Abs", "[", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}], 
            "]"}]}]},
         {"0", "1"}
        }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G3samp", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G4samp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"Inverse", "[", 
      RowBox[{"(", GridBox[{
         {"1", 
          RowBox[{
           RowBox[{"gamsamp", "[", "z", "]"}], "*", 
           RowBox[{"Abs", "[", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"\[Theta]", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}], 
            "]"}]}]},
         {
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{"gamsamp", "[", 
             RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
           RowBox[{"Abs", "[", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}], 
            "]"}]}], 
          RowBox[{"1", "+", 
           RowBox[{"\[Lambda]", "*", 
            RowBox[{"gamsamp", "[", "z", "]"}], "*", 
            RowBox[{"Conjugate", "[", 
             RowBox[{"gamsamp", "[", 
              RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}]}]}
        }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G4samp", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G2samp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"G1samp", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}], ".", 
      RowBox[{"Abs", "[", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"G4samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}], "]"}], ".", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"G3samp", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}]}], ";"}], 
   "  ", 
   RowBox[{"(*", "mine", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"G2samp", "[", 
       RowBox[{"_", ",", "_"}], "]"}], "[", 
      RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1.", "0"},
        {"0", "1."}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"deform", " ", "g4"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"M", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{
          RowBox[{"gam", "[", "z", "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
        {"0", "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Mn", "[", 
        RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
      RowBox[{"(", GridBox[{
         {"1", 
          RowBox[{
           RowBox[{"rb", "[", "k", "]"}], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
         {"0", "1"}
        }], ")"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Msamp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{
          RowBox[{"gamsamp", "[", "z", "]"}], " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
        {"0", "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {
         RowBox[{"\[Lambda]", "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"gam", "[", 
            RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Pn", "[", 
        RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {
          RowBox[{
           RowBox[{"r", "[", "k", "]"}], " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
        }], ")"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Psamp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {
         RowBox[{"\[Lambda]", "*", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"gamsamp", "[", 
            RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"deform", " ", "g2"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]", "[", "z_", "]"}], ":=", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Lambda]", " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"Gam", "[", 
            RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
         RowBox[{"gam", "[", "z", "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Lambda]", " ", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"gam", "[", 
            RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
         RowBox[{"Gam", "[", "z", "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]samp", "[", "z_", "]"}], ":=", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"Gamsamp", "[", 
             RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"gamsamp", "[", "z", "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"gamsamp", "[", 
             RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"Gamsamp", "[", "z", "]"}], "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Lambda]", " ", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"gam", "[", 
                  RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
               RowBox[{"Gam", "[", "z", "]"}]}], ")"}], ")"}]}], "/", 
           RowBox[{"\[Tau]", "[", "z", "]"}]}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Lsamp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"\[Lambda]", " ", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"gamsamp", "[", 
                   RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], 
                "]"}], "+", 
               RowBox[{"Abs", "[", 
                RowBox[{"Gamsamp", "[", "z", "]"}], "]"}]}], ")"}], ")"}]}], 
           "/", 
           RowBox[{"\[Tau]samp", "[", "z", "]"}]}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"U", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Lambda]", " ", 
               RowBox[{"Conjugate", "[", 
                RowBox[{"Gam", "[", 
                 RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
              RowBox[{"gam", "[", "z", "]"}]}], ")"}]}], "/", 
           RowBox[{"\[Tau]", "[", "z", "]"}]}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
        {"0", "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Usamp", "[", 
       RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {"1", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"\[Lambda]", " ", 
                RowBox[{"Conjugate", "[", 
                 RowBox[{"Gamsamp", "[", 
                  RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "]"}],
               "+", 
              RowBox[{"Abs", "[", 
               RowBox[{"gamsamp", "[", "z", "]"}], "]"}]}], ")"}]}], "/", 
           RowBox[{"\[Tau]samp", "[", "z", "]"}]}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
        {"0", "1"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DD", "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"1", "/", 
          RowBox[{"\[Tau]", "[", "z", "]"}]}], "0"},
        {"0", 
         RowBox[{"\[Tau]", "[", "z", "]"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DDsamp", "[", "z_", "]"}], ":=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"1", "/", 
          RowBox[{"\[Tau]samp", "[", "z", "]"}]}], "0"},
        {"0", 
         RowBox[{"\[Tau]samp", "[", "z", "]"}]}
       }], ")"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.538103142394384*^9, 3.538103151534226*^9}, {
   3.5381035800010853`*^9, 3.5381035806070843`*^9}, {3.540653533861*^9, 
   3.540653534101*^9}, {3.5406547841210003`*^9, 3.540654804311*^9}, {
   3.5406548650150003`*^9, 3.540654883401*^9}, {3.5406583132382*^9, 
   3.5406583318182*^9}, {3.5406593163606*^9, 3.5406593424706*^9}, {
   3.5406606785154*^9, 3.5406606829554*^9}, {3.540670035786598*^9, 
   3.540670045469647*^9}, {3.5406701523856287`*^9, 3.540670159109951*^9}, {
   3.540671043884227*^9, 3.5406710445151052`*^9}, {3.54067107622948*^9, 
   3.540671117438383*^9}, 3.540671223981215*^9, 3.540673675932254*^9, {
   3.5406742109124002`*^9, 3.5406742112953997`*^9}, {3.5406777028814*^9, 
   3.5406777049323997`*^9}, {3.5406826023554*^9, 3.5406826068993998`*^9}, {
   3.5406828924653997`*^9, 3.5406828948314*^9}, {3.5406831061644*^9, 
   3.5406831144644003`*^9}, {3.5406844599924*^9, 3.5406844614054003`*^9}, {
   3.5406847746944*^9, 3.5406847750914*^9}, {3.5406849669924*^9, 
   3.5406849737824*^9}, {3.5406851745424*^9, 3.5406852291823997`*^9}, {
   3.5406853996924*^9, 3.5406853998624*^9}, 3.5406876104944*^9, {
   3.5406888923224*^9, 3.5406889113124*^9}, {3.5407250148524*^9, 
   3.5407250177324*^9}, {3.5407255652974*^9, 3.5407255687424*^9}, {
   3.5407264058993998`*^9, 3.5407264153334*^9}, {3.5407270816303997`*^9, 
   3.5407270841644*^9}, {3.5407272503754*^9, 3.5407272625214*^9}, {
   3.5407277902693996`*^9, 3.5407277906574*^9}, {3.5407280626984*^9, 
   3.5407280632244*^9}, {3.540732091156747*^9, 3.540732094732853*^9}, {
   3.5407337077895193`*^9, 3.540733708610265*^9}, {3.540734314953412*^9, 
   3.540734315469853*^9}, {3.540734447769846*^9, 3.540734448600122*^9}, {
   3.5407364063724413`*^9, 3.5407364098191147`*^9}, {3.5407369996439257`*^9, 
   3.54073700378605*^9}, {3.540737269754858*^9, 3.540737270296258*^9}, {
   3.5407374577807903`*^9, 3.540737460562327*^9}, 3.5407388991890717`*^9, {
   3.540739981122607*^9, 3.540739982269462*^9}, {3.540740493804627*^9, 
   3.540740495873988*^9}, {3.540740792568321*^9, 3.540740792845584*^9}, {
   3.540741429871428*^9, 3.540741430139724*^9}, {3.540743857872079*^9, 
   3.5407438622771*^9}, {3.540749237001852*^9, 3.5407492383893623`*^9}, {
   3.5407608990193996`*^9, 3.5407609003594*^9}, {3.5407636848574*^9, 
   3.5407637029354*^9}, {3.5407637497794*^9, 3.5407637906194*^9}, {
   3.5407639569974003`*^9, 3.5407639572774*^9}, 3.5407685188574*^9, {
   3.5407690527953997`*^9, 3.5407690690114*^9}, {3.540839541133526*^9, 
   3.540839547433312*^9}, {3.5409029240854*^9, 3.5409029383283997`*^9}, 
   3.5409035117384*^9, 3.5409416746544*^9, 3.5656171862981997`*^9, {
   3.5656174193571997`*^9, 3.5656174476022*^9}, {3.5656175091342*^9, 
   3.5656175348802*^9}, {3.5656175759962*^9, 3.5656176103392*^9}, {
   3.5656176410592003`*^9, 3.5656176662782*^9}, {3.5656177086092*^9, 
   3.5656177351282*^9}, {3.5656204709592*^9, 3.5656205127052*^9}, {
   3.5656212498292*^9, 3.5656214052762003`*^9}, {3.5656411683152*^9, 
   3.5656411980062*^9}, {3.5656586528082*^9, 3.5656587202482*^9}, {
   3.565754330008767*^9, 3.565754333067934*^9}, 3.796515950553973*^9, {
   3.7965185830018616`*^9, 3.7965186023384657`*^9}, {3.7965205718586073`*^9, 
   3.796520577156417*^9}, {3.7969348916033525`*^9, 3.7969349092509947`*^9}, {
   3.796935077050743*^9, 3.796935098332879*^9}, {3.7969352708665743`*^9, 
   3.7969352893950653`*^9}, {3.7969355083726006`*^9, 3.796935513845967*^9}, {
   3.7970146406135707`*^9, 3.797014817368198*^9}, {3.797014972693786*^9, 
   3.797014996326948*^9}, {3.7970155137981863`*^9, 3.797015516776743*^9}, {
   3.7977707264098873`*^9, 3.797770762972391*^9}, {3.797771337236168*^9, 
   3.797771364189493*^9}, {3.7977714048263617`*^9, 3.797771415594528*^9}, {
   3.7977716511918306`*^9, 3.7977716744832306`*^9}, {3.797771722706914*^9, 
   3.7977717521498556`*^9}, {3.7977720393892837`*^9, 
   3.7977721099987698`*^9}, {3.7983096833460712`*^9, 
   3.7983097085286293`*^9}, {3.7983097434189587`*^9, 
   3.7983097456720214`*^9}, {3.7983097759386473`*^9, 3.798309888600851*^9}, {
   3.7983099422350674`*^9, 3.7983099473329673`*^9}, {3.798312058139866*^9, 
   3.798312135228799*^9}, {3.7983121879117227`*^9, 3.7983123266179295`*^9}, {
   3.7983150593318663`*^9, 3.798315062463583*^9}, {3.7983151849801764`*^9, 
   3.798315188080018*^9}, {3.7983158109853888`*^9, 3.798315833727858*^9}, {
   3.798319578822135*^9, 3.7983195814245615`*^9}, {3.798329305931526*^9, 
   3.798329308914805*^9}, {3.798329609975978*^9, 3.798329638124113*^9}, {
   3.798332230081644*^9, 3.7983322434047456`*^9}, {3.798334975963705*^9, 
   3.798335041768298*^9}, {3.7983350753982735`*^9, 3.798335081460662*^9}, {
   3.7983717650639677`*^9, 3.798371768247864*^9}, {3.7983720877696743`*^9, 
   3.7983721019072995`*^9}, {3.798373434183308*^9, 3.7983734500937166`*^9}, {
   3.8206932375489798`*^9, 3.8206932398418946`*^9}, {3.820702403182755*^9, 
   3.820702407778068*^9}, {3.8207024403892436`*^9, 3.820702445370536*^9}, {
   3.821380743590479*^9, 3.8213807598532963`*^9}, {3.8213910724511323`*^9, 
   3.821391094077812*^9}, {3.8214110108580694`*^9, 3.8214110346461864`*^9}, {
   3.8255240920571175`*^9, 
   3.8255240947018642`*^9}},ExpressionUUID->"8ce9026c-d6d0-4583-bd05-\
de48a65fd073"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shift", "Subsection",
 InitializationGroup->True,
 CellChangeTimes->{{3.538856529637267*^9, 3.538856530444125*^9}, {
   3.5656143675142*^9, 3.5656143832502003`*^9}, 
   3.5656214290852003`*^9},ExpressionUUID->"1d4e4dee-f44e-4218-9fab-\
f154865fb4c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]s", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]ins", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"\[CapitalPhi]in", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", "z_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"gam", "[", 
         RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
      RowBox[{"Gam", "[", "z", "]"}]}], ")"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rs", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"r", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"rsamp", "[", 
     RowBox[{
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]", "[", "z_", "]"}], ":=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"Gam", "[", 
          RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
       RowBox[{"gam", "[", "z", "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"gam", "[", 
          RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "+", 
       RowBox[{"Gam", "[", "z", "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]samp", "[", "z_", "]"}], ":=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"Gamsamp", "[", 
           RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "]"}], "+", 
       RowBox[{"Abs", "[", 
        RowBox[{"gamsamp", "[", "z", "]"}], "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"gamsamp", "[", 
           RowBox[{"Conjugate", "[", "z", "]"}], "]"}], "]"}]}], "]"}], "+", 
       RowBox[{"Abs", "[", 
        RowBox[{"Gamsamp", "[", "z", "]"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Tau]s", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"\[Tau]", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Tau]ssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"\[Tau]samp", "[", 
     RowBox[{
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rb", "[", "k_", "]"}], ":=", 
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"cc", "[", 
     RowBox[{"r", "[", 
      RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rbsamp", "=", "rsamp"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rsb", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"rb", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rsbsamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"rbsamp", "[", 
     RowBox[{
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r4", "[", "z_", "]"}], ":=", 
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"cc", "[", 
     RowBox[{"gam", "[", 
      RowBox[{"cc", "[", "z", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r4b", "[", "z_", "]"}], ":=", 
   RowBox[{"gam", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"r4s", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"r4", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"r4sb", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"r4b", "[", 
     RowBox[{
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r4samp", "[", "z_", "]"}], ":=", 
   RowBox[{"gamsamp", "[", "z", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"r4ssamp", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"r4samp", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r4bsamp", "[", "k_", "]"}], ":=", 
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"cc", "[", 
     RowBox[{"r4samp", "[", 
      RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"r4sbsamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"r4bsamp", "[", 
     RowBox[{
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]ssamp", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"\[CapitalPhi]samp", "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]inssamp", "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
  RowBox[{"\[CapitalPhi]insamp", "[", 
   RowBox[{
    RowBox[{"z", "/", 
     RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
    RowBox[{"x", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]s", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["x", "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "+", 
    RowBox[{"4", " ", "\[ImaginaryI]", " ", 
     SuperscriptBox["z", "2"]}]}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ls", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"rs", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], 
         RowBox[{
          RowBox[{"\[Tau]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Lssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"rssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], 
          RowBox[{
           RowBox[{"\[Tau]ssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Lins", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        FractionBox[
         RowBox[{"-", 
          RowBox[{
           RowBox[{"rs", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], 
         RowBox[{
          RowBox[{"\[Tau]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Linssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         FractionBox[
          RowBox[{"-", 
           RowBox[{
            RowBox[{"rssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], 
          RowBox[{
           RowBox[{"\[Tau]ssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Us", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"rsb", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], 
         RowBox[{
          RowBox[{"\[Tau]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ussamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"rsbsamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], 
          RowBox[{
           RowBox[{"\[Tau]ssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Theta]s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
       {"0", "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Uins", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        FractionBox[
         RowBox[{"-", 
          RowBox[{
           RowBox[{"rsb", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], 
         RowBox[{
          RowBox[{"\[Tau]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Uinssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", 
        RowBox[{
         FractionBox[
          RowBox[{"-", 
           RowBox[{
            RowBox[{"rsbsamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], 
          RowBox[{
           RowBox[{"\[Tau]ssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Theta]s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
       {"0", "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ms", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{
         RowBox[{"r4sb", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Mssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", 
        RowBox[{
         RowBox[{
          RowBox[{"r4sbsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Theta]s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
       {"0", "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mis", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"r4sb", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Missamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"r4sbsamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Theta]s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
       {"0", "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ps", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{
         RowBox[{"r4s", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Pssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         RowBox[{
          RowBox[{"r4ssamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pins", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"r4s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], " ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Pinssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"r4ssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], " ", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
      }], ")"}]}], ";"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DDs", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{"\[Tau]s", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "0"},
      {"0", 
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"\[Tau]s", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DDssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[Tau]ssamp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "0"},
       {"0", 
        RowBox[{"1", "/", 
         RowBox[{
          RowBox[{"\[Tau]ssamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G1s", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{"Gam", "[", 
         RowBox[{
          RowBox[{"z", "/", 
           RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
          RowBox[{"x", "/", 
           RowBox[{"(", 
            RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]s", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"G1ssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{
         RowBox[{"Gamsamp", "[", 
          RowBox[{
           RowBox[{"z", "/", 
            RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
           RowBox[{"x", "/", 
            RowBox[{"(", 
             RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G3s", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"Gam", "[", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "/", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
             RowBox[{"x", "/", 
              RowBox[{"(", 
               RowBox[{"4", " ", "t"}], ")"}]}]}], ")"}], "]"}], "]"}], "]"}],
         "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]s", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"G3ssamp", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", 
        RowBox[{"\[Lambda]", "*", 
         RowBox[{"Conjugate", "[", 
          RowBox[{"Gamsamp", "[", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "/", 
               RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
              RowBox[{"x", "/", 
               RowBox[{"(", 
                RowBox[{"4", " ", "t"}], ")"}]}]}], ")"}], "]"}], "]"}], 
          "]"}], "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"\[Theta]s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]}], "]"}]}]},
       {"0", "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"for", " ", "pole", " ", "calculation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qn", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "a", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"c", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], ">", 
            "expconst"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"out", " ", "=", " ", 
             RowBox[{"out", "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"k", "-", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"k", "-", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{"a", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}]}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "out"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Qn", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{"qn", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "0"},
      {"0", 
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"qn", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Qn", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", 
    RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1.", "0"},
      {"0", "1."}
     }], ")"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/aXPetm9Ca8cVaZD6H0GU6c9ANKX7p2ZA6K/7Tw0
9yGQFrHnWwii7z8Ql3gEpE8Z9Ug9AvOb5UB05yU+eRC9gXmyBkT8tieITl/4
9tpmnzeOni+rr4NogTeu91PK3zgeSM1/AKIXFu+alQ6kRf4bLQTRJoGnVoDo
du+XYPoSj8J6EO3z9el2EP1CZeIpEF13x/sSiLbSS74Poo1ulj8C0Xol1vtz
gPQsDoYDYHqhyzUQvcK9GUzzsEfV5QHpR6pfGkD0B14DtnwgnfHBQAJE31nA
pwSiL9TxaINov+yoKhDN5bMSTE/6y+JVADInXcEfRMsIaAoF1r1xPOenLgKi
AR8VsG8=
  "],ExpressionUUID->"2e54bda2-6944-4885-ba6c-9b8d4650221f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reflection Coefficient", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5407685463534*^9, 3.5407685478054*^9}, {
  3.5657108306542*^9, 
  3.5657108348501997`*^9}},ExpressionUUID->"4c7bd190-ecff-4a61-8106-\
85c263634b1b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"check", " ", "3.1", ".2", " ", "in", " ", "the", " ", "book"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7965244899397993`*^9, 
  3.796524496978774*^9}},ExpressionUUID->"eda5d0fa-84d0-47fc-bac4-\
d7cbb46be5c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CME", "[", "x_", "]"}], ":=", 
   RowBox[{"Chop", "[", 
    RowBox[{"x", ",", "$MachineEpsilon"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScatteringMatrixFiniteNLS", "[", 
    RowBox[{"q_", ",", "n_", ",", "el_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "qf", ",", "qfb", ",", "Dm", ",", "Dmb", ",", "IIm", ",", "IImb", ",", 
       "P", ",", "Pb", ",", "id", ",", "Q", ",", "R", ",", "Qb", ",", "Rb", 
       ",", "DM", ",", "DMb", ",", "q\[Sigma]1", ",", "q\[Sigma]1b", ",", 
       "J\[Sigma]3", ",", "J\[Sigma]31", ",", "J\[Sigma]3b", ",", 
       "J\[Sigma]31b", ",", "rhs", ",", "A", ",", "Ab"}], "}"}], ",", "\n", 
     "       ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"qf", "=", 
        RowBox[{"Fun", "[", 
         RowBox[{"q", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "el"}], ",", "0"}], "}"}], "]"}], ",", "n"}], 
         "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"qfb", "=", 
       RowBox[{"Fun", "[", 
        RowBox[{"q", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "el"}], "}"}], "]"}], ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"qf", "//", "Values"}], "//", "First"}], "//", "Abs"}], 
           ",", 
           RowBox[{"qf", "//", "DCTPlot"}]}], "}"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<q at right end point is \>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"qfb", "//", "Values"}], "//", "Last"}], "//", "Abs"}], 
         ",", "\"\<DCTPlot is \>\"", ",", 
         RowBox[{"qfb", "//", "DCTPlot"}]}], "}"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Dm", "=", 
         RowBox[{"DerivativeMatrix", "[", "qf", "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Dmb", "=", 
       RowBox[{"DerivativeMatrix", "[", "qfb", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"IIm", "=", 
         RowBox[{"ReduceDimensionIntegrateMatrix", "[", "qf", "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"IImb", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ReduceDimensionIntegrateMatrix", "[", 
             RowBox[{"(", 
              RowBox[{"qfb", "//", "ReverseOrientation"}], ")"}], "]"}], "//",
             "Transpose"}], "//", "Reverse"}], "//", "Transpose"}], "//", 
         "Reverse"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"id", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Q", " ", "=", " ", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"qf", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"R", "=", " ", 
         RowBox[{
          RowBox[{"-", "\[Lambda]"}], " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"qf", "//", "Conjugate"}], "//", "Values"}], "]"}]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Qb", " ", "=", " ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"qfb", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Rb", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "\[Lambda]"}], ")"}], " ", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{
          RowBox[{"qfb", "//", "Conjugate"}], "//", "Values"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"BlockMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"id", ",", 
              RowBox[{"-", 
               RowBox[{"IIm", ".", "Q"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"IIm", ".", "R"}]}], ",", "id"}], "}"}]}], "}"}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"id", ",", 
            RowBox[{"-", 
             RowBox[{"IImb", ".", "Qb"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"IImb", ".", "Rb"}]}], ",", "id"}], "}"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"J\[Sigma]3", "=", 
         RowBox[{"BlockMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", "2"}], "I", " ", "IIm"}]}], "}"}]}], "}"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"J\[Sigma]31", "=", 
         RowBox[{"BlockMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", "I", " ", "IIm"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"J\[Sigma]3b", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "*", "id"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"-", "2"}], "I", " ", "IImb"}]}], "}"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"J\[Sigma]31b", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "I", " ", "IImb"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ScatteringMatrixFiniteNLS", "[", 
       RowBox[{
       "qf", ",", "qfb", ",", "A", ",", "Ab", ",", "J\[Sigma]3", ",", 
        "J\[Sigma]31", ",", "J\[Sigma]3b", ",", "J\[Sigma]31b", ",", "IIm", 
        ",", "IImb"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScatteringMatrixFiniteNLS", "[", 
     RowBox[{
     "qf_", ",", "qfb_", ",", "A_", ",", "Ab_", ",", "J\[Sigma]3_", ",", 
      "J\[Sigma]31_", ",", "J\[Sigma]3b_", ",", "J\[Sigma]31b_", ",", "IIm_", 
      ",", "IImb_"}], "]"}], "[", "w_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ans0", ",", "ans1", ",", "rhs", ",", "lhs", ",", "n", ",", "s1", ",", 
       "s2", ",", "qb", ",", "q", ",", "r", ",", "rb"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"qf", "//", "Values"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"qb", " ", "=", " ", 
       RowBox[{"qfb", "//", "Values"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"r", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Lambda]"}], " ", "q"}], "//", "Conjugate"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rb", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "*", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Lambda]"}], " ", "qb"}], ")"}]}], "//", 
        "Conjugate"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"qb", "//", "Length"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"lhs", "=", 
         RowBox[{"A", "+", " ", 
          RowBox[{"w", "*", "J\[Sigma]3"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rhs", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0.", ",", "n"}], "]"}], ",", 
           RowBox[{"IIm", ".", "r"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ans0", " ", "=", " ", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{
           RowBox[{"lhs", "//", "CME"}], ",", 
           RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Linear solve 1 cond=\>\"", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"SingularValueList", "[", 
               RowBox[{"lhs", ",", 
                RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
             RowBox[{"Min", "[", 
              RowBox[{"SingularValueList", "[", 
               RowBox[{"lhs", ",", 
                RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lhs", "=", 
         RowBox[{"A", "+", 
          RowBox[{"w", "*", "J\[Sigma]31"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rhs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"IIm", ".", "q"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0.", ",", "n"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ans1", " ", "=", " ", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{
           RowBox[{"lhs", "//", "CME"}], ",", 
           RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Linear solve 2 cond=\>\"", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"SingularValueList", "[", 
               RowBox[{"lhs", ",", 
                RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
             RowBox[{"Min", "[", 
              RowBox[{"SingularValueList", "[", 
               RowBox[{"lhs", ",", 
                RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
           "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"s1", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ans0", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{"-", 
              RowBox[{"ans1", "[", 
               RowBox[{"[", "n", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ans0", "[", 
              RowBox[{"[", 
               RowBox[{"2", "n"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"ans1", "[", 
                RowBox[{"[", 
                 RowBox[{"2", "n"}], "]"}], "]"}]}], "-", "1"}]}], "}"}]}], 
          "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lhs", "=", 
       RowBox[{"Ab", "+", " ", 
        RowBox[{"w", "*", "J\[Sigma]3b"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhs", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0.", ",", "n"}], "]"}], ",", 
         RowBox[{"IImb", ".", "rb"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ans0", " ", "=", " ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{"lhs", "//", "CME"}], ",", 
         RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Linear solve 3 cond=\>\"", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
           RowBox[{"Min", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
         "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lhs", "=", 
       RowBox[{"Ab", "+", " ", 
        RowBox[{"w", "*", "J\[Sigma]31b"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhs", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"IImb", ".", "qb"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0.", ",", "n"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ans1", " ", "=", " ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{"lhs", "//", "CME"}], ",", 
         RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Linear solve 4 cond=\>\"", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
           RowBox[{"Min", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
         "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"s2", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ans0", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{"ans1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ans0", "[", 
              RowBox[{"[", 
               RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"ans1", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}]}], "}"}]}], 
          "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"s1", "=", 
        RowBox[{
         RowBox[{"Inverse", "[", "s2", "]"}], ".", "s1"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"s1", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ans1", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}], ",", "0"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ans1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}], 
         RowBox[{"??", 
          RowBox[{"?", " ", "test"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ans1", "[", 
             RowBox[{"[", 
              RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}], ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ans1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5407710794914*^9, 3.5407710807813997`*^9}, {
   3.5407711951854*^9, 3.5407712059854*^9}, {3.5407712856654*^9, 
   3.5407713737354*^9}, {3.540827282042986*^9, 3.540827333330905*^9}, {
   3.54083242807616*^9, 3.5408324852837*^9}, {3.540832522921386*^9, 
   3.5408325930834007`*^9}, {3.540832938848312*^9, 3.540832960757762*^9}, {
   3.540832994793727*^9, 3.5408330192890873`*^9}, {3.540833097880999*^9, 
   3.540833104398241*^9}, {3.5408331497947607`*^9, 3.540833157137931*^9}, {
   3.540833189894033*^9, 3.540833239916215*^9}, {3.5408333534680634`*^9, 
   3.540833375999275*^9}, {3.540833439903254*^9, 3.540833457391617*^9}, 
   3.5409039382404003`*^9, {3.5409378931194*^9, 3.5409379107794*^9}, {
   3.5409397365383997`*^9, 3.5409397675624*^9}, 3.5409398277864*^9, {
   3.5409399836464*^9, 3.5409399892994003`*^9}, {3.5409422127864*^9, 
   3.5409422401823997`*^9}, {3.541851859895*^9, 3.541851909367*^9}, {
   3.5418522254849997`*^9, 3.541852231517*^9}, {3.5418533264820004`*^9, 
   3.541853326612*^9}, {3.5463628431070004`*^9, 3.5463628486429996`*^9}, {
   3.5463662630164003`*^9, 3.5463662636764*^9}, {3.5656340548582*^9, 
   3.5656340797651997`*^9}, {3.5656341116712*^9, 3.5656341309472*^9}, {
   3.5656341613592*^9, 3.5656341633571997`*^9}, {3.5657105213012*^9, 
   3.5657105408712*^9}, {3.5657557671034803`*^9, 3.5657557769551697`*^9}, {
   3.5657559916336403`*^9, 3.5657559932735453`*^9}, 3.690497423434519*^9, {
   3.690497725117401*^9, 3.6904977586037426`*^9}, {3.7022270492003627`*^9, 
   3.7022270573080387`*^9}, {3.7964946028730636`*^9, 3.796494604331215*^9}, {
   3.7964971570284586`*^9, 3.7964973072883663`*^9}, {3.7964973567722178`*^9, 
   3.7964974046287117`*^9}, {3.7964974609315295`*^9, 
   3.7964974830338902`*^9}, {3.796497766108945*^9, 3.796497774317278*^9}, {
   3.7964978577920704`*^9, 3.7964978730972204`*^9}, {3.796523462443473*^9, 
   3.796523471872425*^9}, {3.796523602384591*^9, 3.796523607794937*^9}, {
   3.7965240712809725`*^9, 3.7965240816292152`*^9}, {3.796524584229142*^9, 
   3.7965246287021227`*^9}, {3.7965246598528323`*^9, 3.796524661216962*^9}, 
   3.7965247877062235`*^9, 3.796524942654992*^9, 
   3.796931715744079*^9},ExpressionUUID->"39526c4e-cc3c-4f36-bf04-\
d47a659c1709"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScatteringMatrixBFiniteNLS", "[", 
    RowBox[{"g0_", ",", "g1_", ",", "n_", ",", "el_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "g0fb", ",", "g1fb", ",", "Dm", ",", "Dmb", ",", "IIm", ",", "IImb", 
       ",", "P", ",", "Pb", ",", "id", ",", "g0Qb", ",", "g02Qb", ",", "g1Qb",
        ",", "g0Rb", ",", "g1Rb", ",", "DM", ",", "DMb", ",", "q\[Sigma]1", 
       ",", "q\[Sigma]1b", ",", "J\[Sigma]3", ",", "J\[Sigma]31", ",", 
       "J\[Sigma]3b", ",", "J\[Sigma]31b", ",", "rhs", ",", "A0b", ",", "A1b",
        ",", "A2b", ",", "A3b"}], "}"}], ",", "\n", "       ", 
     RowBox[{
      RowBox[{"g0fb", "=", 
       RowBox[{"Fun", "[", 
        RowBox[{"g0", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "el"}], "}"}], "]"}], ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g1fb", "=", 
       RowBox[{"Fun", "[", 
        RowBox[{"g1", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "el"}], "}"}], "]"}], ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"\"\<g0 at right end point is \>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"g0fb", "//", "Values"}], "//", "Last"}], "//", "Abs"}], 
         ",", "\"\<DCTPlot is \>\"", ",", 
         RowBox[{"g0fb", "//", "DCTPlot"}]}], "}"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"IIm", "=", 
         RowBox[{"ReduceDimensionIntegrateMatrix", "[", "qf", "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"IImb", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ReduceDimensionIntegrateMatrix", "[", 
             RowBox[{"(", 
              RowBox[{"g0fb", "//", "ReverseOrientation"}], ")"}], "]"}], "//",
             "Transpose"}], "//", "Reverse"}], "//", "Transpose"}], "//", 
         "Reverse"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"id", "=", 
       RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Q", " ", "=", " ", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"qf", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"R", "=", " ", 
         RowBox[{
          RowBox[{"-", "\[Lambda]"}], " ", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{
            RowBox[{"qf", "//", "Conjugate"}], "//", "Values"}], "]"}]}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g0Qb", " ", "=", " ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"g0fb", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g02Qb", " ", "=", " ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"g0fb", "//", "Values"}], "]"}], "^", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g0Rb", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "\[Lambda]"}], ")"}], " ", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{
          RowBox[{"g0fb", "//", "Conjugate"}], "//", "Values"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"g1Qb", " ", "=", " ", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"g1fb", "//", "Values"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g1Rb", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "\[Lambda]"}], ")"}], " ", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{
          RowBox[{"g1fb", "//", "Conjugate"}], "//", "Values"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"BlockMatrix", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"id", ",", 
              RowBox[{"-", 
               RowBox[{"IIm", ".", "Q"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"IIm", ".", "R"}]}], ",", "id"}], "}"}]}], "}"}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"A0b", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"id", ",", 
            RowBox[{"id", "*", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"id", "*", "0"}], ",", "id"}], "}"}]}], "}"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"A1b", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"id", "*", "0"}], ",", 
            RowBox[{"IImb", ".", "g0Qb"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IImb", ".", "g0Rb"}], ",", 
            RowBox[{"id", "*", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A2b", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"id", "*", "0"}], ",", 
            RowBox[{"-", 
             RowBox[{"IImb", ".", "g1Qb"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IImb", ".", "g1Rb"}], ",", 
            RowBox[{"id", "*", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A3b", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IImb", ".", "g02Qb"}], ",", 
            RowBox[{"id", "*", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"id", "*", "0"}], ",", 
            RowBox[{"-", 
             RowBox[{"IImb", ".", "g02Qb"}]}]}], "}"}]}], "}"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"J\[Sigma]31b", "=", 
       RowBox[{"BlockMatrix", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"4", "I", " ", "IImb"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"0", "*", "id"}]}], "}"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ScatteringMatrixFiniteNLS", "[", 
       RowBox[{
       "g0fb", ",", "g1fb", ",", "A0b", ",", "A1b", ",", "A2b", ",", "A3b", 
        ",", "J\[Sigma]3", ",", "J\[Sigma]31", ",", "J\[Sigma]3b", ",", 
        "J\[Sigma]31b", ",", "IIm", ",", "IImb"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScatteringMatrixFiniteNLS", "[", 
     RowBox[{
     "g0fb_", ",", "g1fb_", ",", "A0b_", ",", "A1b_", ",", "A2b_", ",", 
      "A3b_", ",", "J\[Sigma]3_", ",", "J\[Sigma]31_", ",", "J\[Sigma]3b_", 
      ",", "J\[Sigma]31b_", ",", "IIm_", ",", "IImb_"}], "]"}], "[", "w_", 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ans0", ",", "ans1", ",", "rhs", ",", "lhs", ",", "n", ",", "s1", ",", 
       "s2", ",", "qt1b", ",", "qt2b", ",", "r", ",", "rb"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"qf", "//", "Values"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"qt1b", " ", "=", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"2", "*", "w", "*", "g0fb"}], "+", 
          RowBox[{"I", "*", "g1fb"}]}], ")"}], "//", "Values"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qt2b", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"I", "*", 
          RowBox[{"(", 
           RowBox[{"-", "\[Lambda]"}], ")"}], "*", 
          RowBox[{
           RowBox[{"Abs", "[", "g0fb", "]"}], "^", "2"}]}], ")"}], "//", 
        "Values"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"r", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Lambda]"}], " ", "q"}], "//", "Conjugate"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"rb", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "*", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[Lambda]"}], " ", "qb"}], ")"}]}], "//", 
          "Conjugate"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"qt1b", "//", "Length"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lhs", "=", 
       RowBox[{"A0b", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"w", "^", "2"}], ")"}], "*", "J\[Sigma]31b"}], "-", 
        RowBox[{"2", "*", "w", "*", "A1b"}], "+", 
        RowBox[{"I", "*", "A2b"}], "+", 
        RowBox[{"I", "*", " ", 
         RowBox[{"(", 
          RowBox[{"-", "\[Lambda]"}], ")"}], "*", "A3b"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rhs", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"IImb", ".", "qt1b"}], ",", 
         RowBox[{"IImb", ".", "qt2b"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ans1", " ", "=", " ", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{"lhs", "//", "CME"}], ",", 
         RowBox[{"rhs", "//", "CME"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Linear solve 4 cond=\>\"", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}], "/", 
           RowBox[{"Min", "[", 
            RowBox[{"SingularValueList", "[", 
             RowBox[{"lhs", ",", 
              RowBox[{"Tolerance", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "ans1", "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"s2", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ans0", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], ",", 
             RowBox[{"ans1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ans0", "[", 
              RowBox[{"[", 
               RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"ans1", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}]}], "}"}]}], 
          "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"s1", "=", 
        RowBox[{
         RowBox[{"Inverse", "[", "s2", "]"}], ".", "s1"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"s1", "=", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"ans1", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}], ",", "0"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ans1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}], 
         RowBox[{"??", 
          RowBox[{"?", " ", "test"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"s1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"ans1", "[", 
             RowBox[{"[", 
              RowBox[{"n", "+", "1"}], "]"}], "]"}], "+", "1"}], ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ans1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8013330166383934`*^9, 3.801333029308623*^9}, {
   3.801334011878838*^9, 3.801334051877925*^9}, {3.801334389742737*^9, 
   3.8013344301859436`*^9}, {3.8013348900942717`*^9, 
   3.8013348902150345`*^9}, {3.8013381057413464`*^9, 
   3.8013381125963106`*^9}, {3.8013396548167872`*^9, 3.801339658120381*^9}, {
   3.8013397306080112`*^9, 3.8013397878551455`*^9}, {3.8013409075427237`*^9, 
   3.8013409379836717`*^9}, {3.8013409954252005`*^9, 
   3.8013411560088577`*^9}, {3.8013411967871375`*^9, 3.801341205752929*^9}, {
   3.801342650766539*^9, 3.8013426834926972`*^9}, {3.801342719260255*^9, 
   3.801342791525158*^9}, {3.801343036626213*^9, 3.8013430587203016`*^9}, {
   3.8013430907458644`*^9, 3.8013433797615156`*^9}, {3.801343447821476*^9, 
   3.801343452493577*^9}, {3.801343666656149*^9, 3.801343667494059*^9}, {
   3.801343900839517*^9, 3.801343901585493*^9}, {3.8013440985415173`*^9, 
   3.8013441121746216`*^9}, 3.801349897516256*^9, {3.8013500073026123`*^9, 
   3.801350007644697*^9}, {3.801350200246415*^9, 3.801350202755436*^9}, 
   3.8018525482970924`*^9, 3.801853101383377*^9, {3.8217327054490924`*^9, 
   3.8217327220094175`*^9}},ExpressionUUID->"ff5ac093-7774-42a1-a671-\
8be13dbdc55f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eigenvalues", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5407715647813997`*^9, 3.5407715708213997`*^9}, {
   3.5407718315214*^9, 3.5407718358213997`*^9}, 
   3.568127365394457*^9},ExpressionUUID->"e247ff98-4ffb-44eb-9a90-\
68cf27800d10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HillNLS", "[", 
    RowBox[{"F_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c2", ",", "c1", ",", "c0", ",", "f11", ",", "f12", ",", "zz", ",", 
       "f02", ",", "f01", ",", "t", ",", "A", ",", "mu", ",", "L", ",", "P", 
       ",", "fun"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", " ", "=", " ", ".25"}], ";", "\[IndentingNewLine]", 
      RowBox[{"L", " ", "=", " ", "Pi"}], ";", "\[IndentingNewLine]", 
      RowBox[{"P", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f11", "[", "x_", "]"}], ":=", " ", 
       RowBox[{"2", "I", " ", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x", "/", "2"}], "]"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f12", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "2"}], "I", " ", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x", "/", "2"}], "]"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zz", "[", "x_", "]"}], ":=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "[", "x_", "]"}], " ", ":=", " ", 
       RowBox[{"Tan", "[", 
        RowBox[{"x", "/", "2"}], "]"}]}], ";", "   ", 
      RowBox[{"(*", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f02", "[", "x_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{"-", "I"}], " ", 
        RowBox[{"F", "[", 
         RowBox[{"t", "[", "x", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f01", "[", "x_", "]"}], ":=", 
       RowBox[{
        RowBox[{"-", "\[Lambda]"}], " ", "I", " ", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"F", "[", 
          RowBox[{"t", "[", "x", "]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fun", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"zz", ",", "f11"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"f02", ",", "zz"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"f01", ",", "zz"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zz", ",", "f12"}], "}"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"A", "=", " ", 
       RowBox[{"Hill", "[", 
        RowBox[{"mu", ",", "L", ",", "n", ",", "P", ",", "fun"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Eigenvalues", "[", 
       RowBox[{"Chop", "[", 
        RowBox[{"A", ",", "$MachineEpsilon"}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocatePolesNLS", "[", 
    RowBox[{"F_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eval", ",", "s", ",", "i", ",", "sys", ",", "vecs"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Off", "[", 
       RowBox[{"General", "::", "unfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"eval", "=", 
       RowBox[{"HillNLS", "[", 
        RowBox[{"F", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "eval", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"eval", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", 
             RowBox[{"10", "^", 
              RowBox[{"(", 
               RowBox[{"-", "4"}], ")"}]}]}], "&&", " ", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"eval", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", "30"}]}], ",", 
           "  ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"why", " ", "this", " ", "condition"}], ",", " ", 
             RowBox[{
             "looking", " ", "for", " ", "non", " ", "real", " ", "eigen", 
              " ", "value"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"s", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{"eval", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"On", "[", 
       RowBox[{"General", "::", "unfl"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Chop", "[", 
       RowBox[{"s", ",", "$MachineEpsilon"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.503864765345394*^9, 3.503864805342846*^9}, {
   3.50386734288988*^9, 3.503867354117487*^9}, {3.503927760898873*^9, 
   3.503927788744951*^9}, {3.503927896065843*^9, 3.503927898017088*^9}, {
   3.503927946305841*^9, 3.503927987465645*^9}, {3.503928052874394*^9, 
   3.503928083824047*^9}, {3.503928147881987*^9, 3.503928148234082*^9}, {
   3.503928256325563*^9, 3.503928300122334*^9}, {3.503928344716576*^9, 
   3.503928374380585*^9}, {3.50392844123773*^9, 3.503928460781448*^9}, 
   3.503928811980692*^9, {3.503929274135363*^9, 3.503929285314468*^9}, {
   3.503929315402057*^9, 3.503929319956047*^9}, {3.503929410566998*^9, 
   3.503929421191896*^9}, {3.503929577459712*^9, 3.503929582154504*^9}, {
   3.503929719644224*^9, 3.503929721700133*^9}, {3.503929866254088*^9, 
   3.503929911131696*^9}, {3.503930134680891*^9, 3.503930136866754*^9}, {
   3.503930189879069*^9, 3.50393023334754*^9}, {3.503930273900549*^9, 
   3.503930293646057*^9}, {3.503930944205041*^9, 3.503931066589187*^9}, {
   3.503931179513111*^9, 3.503931190473869*^9}, {3.503931261887096*^9, 
   3.503931274581136*^9}, {3.503931328583484*^9, 3.503931370004759*^9}, {
   3.503931407748326*^9, 3.503931407914923*^9}, {3.503933307782749*^9, 
   3.503933338694513*^9}, {3.503933407486908*^9, 3.503933415562467*^9}, {
   3.503937036128636*^9, 3.503937097560886*^9}, {3.503937144941339*^9, 
   3.5039372344975*^9}, {3.503942000708616*^9, 3.503942006005069*^9}, {
   3.504021886951573*^9, 3.504021908326655*^9}, 3.504022004000711*^9, {
   3.504026086567231*^9, 3.5040260878016148`*^9}, {3.50403068418861*^9, 
   3.504030757608275*^9}, {3.504030876667343*^9, 3.5040308791785603`*^9}, {
   3.504030997464014*^9, 3.504031027125536*^9}, 3.504038920402371*^9, 
   3.504209954034*^9, {3.504288326676*^9, 3.5042883269779997`*^9}, {
   3.504288441027*^9, 3.504288477814*^9}, {3.504289857642*^9, 
   3.504289858402*^9}, {3.5407716014814*^9, 3.5407716027114*^9}, 
   3.5407716386614*^9, {3.5407719168714*^9, 3.5407719180313997`*^9}, {
   3.540819210863092*^9, 3.540819242095166*^9}, {3.5408193660846148`*^9, 
   3.540819366450569*^9}, {3.5408193964676313`*^9, 3.5408194758801203`*^9}, {
   3.540819555536408*^9, 3.540819556390916*^9}, {3.5408196042185926`*^9, 
   3.540819612305895*^9}, {3.540819671349736*^9, 3.540819675616293*^9}, {
   3.540819729135867*^9, 3.540819757771803*^9}, {3.540819789000448*^9, 
   3.5408198461157084`*^9}, {3.540819888599984*^9, 3.540819890027162*^9}, {
   3.540820020626029*^9, 3.540820021597898*^9}, {3.540820098695648*^9, 
   3.5408201005555162`*^9}, {3.5408202408286858`*^9, 
   3.5408202687408543`*^9}, {3.540820321710685*^9, 3.540820328094551*^9}, {
   3.540820553869779*^9, 3.540820554671226*^9}, {3.540822490776183*^9, 
   3.540822493533906*^9}, 3.540822752068866*^9, 3.540824355901135*^9, {
   3.5408246853957*^9, 3.540824692701099*^9}, {3.540824833322504*^9, 
   3.540824834876959*^9}, 3.5408259865319223`*^9, 3.540826038947308*^9, {
   3.540826808489683*^9, 3.5408268708637342`*^9}, {3.540826915162272*^9, 
   3.5408269581927977`*^9}, {3.5408271078611097`*^9, 
   3.5408271324618607`*^9}, {3.54082718124622*^9, 3.540827188794232*^9}, {
   3.540827337957547*^9, 3.540827349109482*^9}, {3.540827412064855*^9, 
   3.5408274331891947`*^9}, {3.540827549372154*^9, 3.540827550711824*^9}, {
   3.540827628516138*^9, 3.5408276295311623`*^9}, {3.540827877893024*^9, 
   3.5408279490002537`*^9}, {3.5408279927693577`*^9, 
   3.5408280131059647`*^9}, {3.540828059326911*^9, 3.540828061706418*^9}, {
   3.540829392842729*^9, 3.540829401968701*^9}, {3.5408295466109047`*^9, 
   3.540829622330606*^9}, {3.540829953239996*^9, 3.540830067552009*^9}, {
   3.5408301538417063`*^9, 3.540830244152267*^9}, {3.540830321272368*^9, 
   3.5408303830032377`*^9}, {3.5408304162939*^9, 3.540830421493327*^9}, {
   3.540830456136663*^9, 3.5408304918362827`*^9}, {3.540830587455862*^9, 
   3.540830617324831*^9}, {3.540830691921343*^9, 3.540831056314954*^9}, {
   3.540831608134359*^9, 3.5408316306763678`*^9}, {3.5408316674284143`*^9, 
   3.540831669679337*^9}, {3.5408317019517603`*^9, 3.5408318074256*^9}, {
   3.540832026525626*^9, 3.540832035502232*^9}, {3.540832158612021*^9, 
   3.540832243751718*^9}, {3.540832501772859*^9, 3.540832506780499*^9}, {
   3.540833501624042*^9, 3.540833513093803*^9}, {3.5408335771994057`*^9, 
   3.5408336144965353`*^9}, {3.540833648919447*^9, 3.5408337244834538`*^9}, {
   3.540833784451839*^9, 3.54083379823851*^9}, {3.5409036826043997`*^9, 
   3.5409036950864*^9}, {3.5409394960243998`*^9, 3.5409394988104*^9}, {
   3.5409396370864*^9, 3.5409396403943996`*^9}, {3.5409401144063997`*^9, 
   3.5409401188244*^9}, {3.5409401593434*^9, 3.5409402168314*^9}, {
   3.5409412717883997`*^9, 3.5409412754384003`*^9}, {3.5409415184994*^9, 
   3.5409415298993998`*^9}, {3.5409415622944*^9, 3.5409415657074003`*^9}, {
   3.5409416069434*^9, 3.5409416072334003`*^9}, {3.5657105550022*^9, 
   3.5657105555122004`*^9}, {3.568126182652104*^9, 3.568126182853517*^9}, {
   3.6584554275393305`*^9, 3.65845543936436*^9}, {3.6584558158253603`*^9, 
   3.65845582178683*^9}, {3.6584567644922314`*^9, 
   3.6584567747258167`*^9}},ExpressionUUID->"86b6bc4e-c883-4652-a18b-\
3667d129609b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region 0: Undeformed", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.538443201592167*^9, 3.538443212095222*^9}, {
   3.5656156095022*^9, 3.5656156113522*^9}, 
   3.5656208942292*^9},ExpressionUUID->"c7d69baa-297b-4b74-bcea-c731d1cead62"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", "0", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"G1", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G2", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G3", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G4", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"el", "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "el"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "el"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jsamp", "[", "0", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"G1samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G2samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G3samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G4samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"el", "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "el"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "el"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jadapt", "[", "0", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Adapt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jsamp", "[", "0", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
    RowBox[{
     RowBox[{"J", "[", "0", "]"}], "[", 
     RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jadapt", "[", "0", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"J", "[", "0", "]"}], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], ";"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5406576785462*^9, 3.5406577161661997`*^9}, {
   3.5406582201982*^9, 3.5406582273082*^9}, 3.5406586749382*^9, 
   3.5407609243294*^9, {3.5408422052614202`*^9, 3.540842205632593*^9}, {
   3.540842429716239*^9, 3.540842429846467*^9}, {3.5409332732904*^9, 
   3.5409333148454*^9}, {3.541861619785755*^9, 3.541861623452838*^9}, {
   3.541861656327001*^9, 3.541861658902041*^9}, {3.5423735388424*^9, 
   3.5423735413424*^9}, {3.5424025499314003`*^9, 3.5424025521113997`*^9}, {
   3.5656156244642*^9, 3.5656156262852*^9}, {3.5656183001152*^9, 
   3.5656183043241997`*^9}, {3.5656205355512*^9, 3.5656205799202003`*^9}, {
   3.5656206584592*^9, 3.5656206776342*^9}, {3.5656208891191998`*^9, 
   3.5656208914672003`*^9}, {3.5656305467581997`*^9, 3.5656305490722*^9}, {
   3.5657106489052*^9, 3.5657106655822*^9}, {3.796516364088929*^9, 
   3.7965163683096323`*^9}, {3.796516947399538*^9, 3.7965170344414062`*^9}, {
   3.79651845643692*^9, 3.7965184895392847`*^9}, 3.796518634347796*^9, {
   3.7970144498247333`*^9, 3.7970144674686985`*^9}, {3.7970146018870883`*^9, 
   3.7970146121770506`*^9}, {3.7970157066204114`*^9, 3.797015729790479*^9}, {
   3.825527991564165*^9, 
   3.82552801110015*^9}},ExpressionUUID->"d9011f29-c848-439c-b2dd-\
6acbb306ff66"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region 3: Undeformed faster decay", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.538443201592167*^9, 3.538443212095222*^9}, {
   3.5656156095022*^9, 3.5656156113522*^9}, 3.5656208942292*^9, {
   3.8232120413685064`*^9, 3.8232120545193663`*^9}, 
   3.8232120867995996`*^9},ExpressionUUID->"47a70790-9558-485d-b4bd-\
7433058c7e36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gam0", "[", "k_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"q00", "/", "2"}], "/", "I"}], "/", 
     RowBox[{"(", 
      RowBox[{"k", "-", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", "I"}]}], ")"}]}], ")"}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"1", "+", 
    RowBox[{
    "2", "I", " ", "works", " ", "amazingly", " ", "as", " ", "it", " ", 
     "cancels", " ", "exactly"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gam0", "[", "k_", "]"}], ":=", 
   RowBox[{"\[Lambda]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Conjugate", "[", "q00", "]"}], "/", "2"}], "/", "I"}], "/", 
     RowBox[{"(", 
      RowBox[{"k", "-", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "I"}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gamb0", "[", "k_", "]"}], ":=", 
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"cc", "[", 
     RowBox[{"gam0", "[", 
      RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gamb0", "[", "k_", "]"}], ":=", 
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"cc", "[", 
     RowBox[{"Gam0", "[", 
      RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gamb", "[", "k_", "]"}], ":=", 
   RowBox[{"\[Lambda]", "*", 
    RowBox[{"Conjugate", "[", 
     RowBox[{"gam", "[", 
      RowBox[{"Conjugate", "[", "k", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gamb", "[", "k_", "]"}], ":=", 
    RowBox[{"\[Lambda]", "*", 
     RowBox[{"Conjugate", "[", 
      RowBox[{"Gam", "[", 
       RowBox[{"Conjugate", "[", "k", "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G4a", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gam", "[", "k", "]"}], "-", 
           RowBox[{"gam0", "[", "k", "]"}]}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gamb", "[", "k", "]"}], "-", 
           RowBox[{"gamb0", "[", "k", "]"}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gam", "[", "k", "]"}], "-", 
          RowBox[{"gam0", "[", "k", "]"}]}], ")"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"gamb", "[", "k", "]"}], "-", 
          RowBox[{"gamb0", "[", "k", "]"}]}], ")"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G4a", "[", 
     RowBox[{"_", ",", "_"}], "]"}], "[", 
    RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1.", "0"},
      {"0", "1."}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G1a", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Gam", "[", "k", "]"}], "-", 
           RowBox[{"Gam0", "[", "k", "]"}]}], ")"}]}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G1a", "[", 
     RowBox[{"_", ",", "_"}], "]"}], "[", 
    RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1.", "0"},
      {"0", "1."}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G3a", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Gamb", "[", "k", "]"}], "-", 
           RowBox[{"Gamb0", "[", "k", "]"}]}], ")"}]}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G3a", "[", 
     RowBox[{"_", ",", "_"}], "]"}], "[", 
    RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1.", "0"},
      {"0", "1."}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G2a", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]}]]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Gamb", "[", "k", "]"}], "+", 
           RowBox[{"gam", "[", "k", "]"}]}], ")"}]}]},
       {
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}]]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gamb", "[", "k", "]"}], "+", 
           RowBox[{"Gam", "[", "k", "]"}]}], ")"}]}], 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Gamb", "[", "k", "]"}], "+", 
            RowBox[{"gam", "[", "k", "]"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gamb", "[", "k", "]"}], "+", 
            RowBox[{"Gam", "[", "k", "]"}]}], ")"}]}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"G2a", "[", 
     RowBox[{"_", ",", "_"}], "]"}], "[", 
    RowBox[{"_", "?", "InfinityQ"}], "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1.", "0"},
      {"0", "1."}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", "3", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"G1a", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G2a", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G3a", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G4a", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"el", "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "el"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "*", "el"}]}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bigN", ",", 
       RowBox[{"2", "*", "bigN"}], ",", "bigN", ",", 
       RowBox[{"4", "*", "bigN"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jsamp", "[", "3", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"G1samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G2samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G3samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"G4samp", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"el", "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "el"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "el"}], "*", "I"}], ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "*", "el"}]}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"bigN", ",", 
       RowBox[{"2", "*", "bigN"}], ",", "bigN", ",", 
       RowBox[{"4", "*", "bigN"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jadapt", "[", "3", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Adapt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jsamp", "[", "3", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
    RowBox[{
     RowBox[{"J", "[", "3", "]"}], "[", 
     RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jadapt", "[", "0", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"J", "[", "0", "]"}], "[", 
      RowBox[{"x", ",", "t"}], "]"}]}], ";"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5406576785462*^9, 3.5406577161661997`*^9}, {
   3.5406582201982*^9, 3.5406582273082*^9}, 3.5406586749382*^9, 
   3.5407609243294*^9, {3.5408422052614202`*^9, 3.540842205632593*^9}, {
   3.540842429716239*^9, 3.540842429846467*^9}, {3.5409332732904*^9, 
   3.5409333148454*^9}, {3.541861619785755*^9, 3.541861623452838*^9}, {
   3.541861656327001*^9, 3.541861658902041*^9}, {3.5423735388424*^9, 
   3.5423735413424*^9}, {3.5424025499314003`*^9, 3.5424025521113997`*^9}, {
   3.5656156244642*^9, 3.5656156262852*^9}, {3.5656183001152*^9, 
   3.5656183043241997`*^9}, {3.5656205355512*^9, 3.5656205799202003`*^9}, {
   3.5656206584592*^9, 3.5656206776342*^9}, {3.5656208891191998`*^9, 
   3.5656208914672003`*^9}, {3.5656305467581997`*^9, 3.5656305490722*^9}, {
   3.5657106489052*^9, 3.5657106655822*^9}, {3.796516364088929*^9, 
   3.7965163683096323`*^9}, {3.796516947399538*^9, 3.7965170344414062`*^9}, {
   3.79651845643692*^9, 3.7965184895392847`*^9}, 3.796518634347796*^9, {
   3.7970144498247333`*^9, 3.7970144674686985`*^9}, {3.7970146018870883`*^9, 
   3.7970146121770506`*^9}, {3.7970157066204114`*^9, 3.797015729790479*^9}, {
   3.823212247337364*^9, 3.823212248682511*^9}, {3.823212396525705*^9, 
   3.823212418781582*^9}, {3.823212518848179*^9, 3.823212602299738*^9}, {
   3.8232130799220314`*^9, 
   3.82321308337875*^9}},ExpressionUUID->"d56e2b23-4347-4a4a-9845-\
0af06ed4d559"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Region 1: Small t (later try to optimize with G4 deleted, since iv is \
reflectionless )\
\>", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5656277702742*^9, 3.5656277744342003`*^9}, {
  3.825528838025182*^9, 
  3.8255289099776516`*^9}},ExpressionUUID->"e524acd8-237f-48a9-b708-\
fa6781d643b5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SmallTimeContour", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "el"}], " ", "+", " ", 
          RowBox[{"I", " ", "\[Nu]"}]}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "3", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "3", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", "0"}], "}"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "el"}], ",", "0"}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "el"}], " ", "-", " ", 
          RowBox[{"I", " ", "\[Nu]"}]}], ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "5", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", "5", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", "0"}], "}"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"I", " ", "\[Nu]"}], " ", "+", " ", "el"}]}], "}"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}]}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "I"}], " ", "\[Nu]"}], " ", "+", " ", "el"}]}], "}"}],
        "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Modk0", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"t", " ", "<", " ", 
       RowBox[{"10", "*", "$MachineEpsilon"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sign", "[", "x", "]"}]}], "*", "100"}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sign", "[", "x", "]"}]}], "*", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"x", "/", 
           RowBox[{"(", 
            RowBox[{"4", "t"}], ")"}]}], "]"}], ",", "100"}], "]"}]}]}], 
     "]"}]}], ";"}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5656280583422003`*^9, 3.5656280652251997`*^9}, {
   3.5656285659852*^9, 3.5656287457122*^9}, {3.5656292517061996`*^9, 
   3.5656292519751997`*^9}, {3.5656349460212*^9, 3.5656349839392*^9}, {
   3.5656350144561996`*^9, 3.5656350657841997`*^9}, {3.5656351399231997`*^9, 
   3.5656352555312*^9}, {3.5656353864282*^9, 3.5656353951102*^9}, 
   3.5656354339372*^9, {3.5657106309172*^9, 3.5657106321812*^9}, {
   3.7983064563066225`*^9, 
   3.7983064605197563`*^9}},ExpressionUUID->"5fae13f7-2710-4d45-8b50-\
ba6de950f5f4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"J", "[", "1", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Un", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Un", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DDn", "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Ln", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Ln", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Pn", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Pn", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Mn", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Mn", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
      ",", " ", 
      RowBox[{"SmallTimeContour", " ", "+", " ", 
       RowBox[{"Modk0", "[", 
        RowBox[{"x", ",", "t"}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "bigN", ",", "smallN", ",", "bigN", ",", "bigN", ",", "smallN", ",", 
        "smallN", ",", "bigN", ",", "smallN", ",", "bigN"}], "}"}]}], "}"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jsamp", "[", "1", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Unsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Unsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DDnsamp", "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Lnsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Lnsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Pnsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Pnsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Mnsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Mnsamp", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
      ",", " ", 
      RowBox[{"SmallTimeContour", " ", "+", " ", 
       RowBox[{"Modk0", "[", 
        RowBox[{"x", ",", "t"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
       "bigN", ",", "smallN", ",", "bigN", ",", "bigN", ",", "smallN", ",", 
        "smallN", ",", "bigN", ",", "smallN", ",", "bigN"}], "}"}]}], "}"}]}],
    ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jadapt", "[", "1", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Adapt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Jsamp", "[", "1", "]"}], "[", 
        RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
     RowBox[{
      RowBox[{"J", "[", "1", "]"}], "[", 
      RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5656277803342*^9, 3.5656277942142*^9}, {
   3.5656278543152*^9, 3.5656280347212*^9}, 3.5656285803831997`*^9, {
   3.5656287904302*^9, 3.5656289367002*^9}, {3.5656354431261997`*^9, 
   3.5656354619342003`*^9}, {3.5656355936562*^9, 3.5656356693892*^9}, 
   3.798306188195718*^9, {3.7983064621524677`*^9, 
   3.7983064652713933`*^9}},ExpressionUUID->"f4e2ba9e-b4af-48be-9ac8-\
07235bc0bdf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"s0", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"N", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "t", "]"}], "<", "0.0001"}], ",", 
        RowBox[{"-", "el"}], ",", 
        RowBox[{"-", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "/", "4"}], "/", "t"}], ",", "el"}], "]"}]}]}], 
       "]"}], "]"}]}], ";", 
    RowBox[{"this", " ", "is", " ", "prob", " ", "not", " ", "good"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"s0", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "x"}], "/", "4"}], "/", "t"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"G1", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"G1", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"L", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"DD", "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"U", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"G3", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"G3", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "+", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "+", 
             RowBox[{"I", "*", "el"}]}], ",", 
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "+", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "+", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"s0", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], "I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "-", "el"}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "el"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "-", "el"}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "G3", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "-", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "-", 
             RowBox[{"I", "*", "el"}]}], ",", 
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "-", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "-", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"s0", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN", ",", 
         RowBox[{"bigN", "*", "4"}], ",", "bigN", ",", "bigN", ",", "bigN", 
         ",", "bigN"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jsamp", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"G1samp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"G1samp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Lsamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Lsamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{"DDsamp", "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Usamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Usamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"G3samp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"G3samp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "+", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "+", 
             RowBox[{"I", "*", "el"}]}], ",", 
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "+", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "+", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"s0", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "3"}], "I", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "-", "el"}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "el"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "3", "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}], "*", "\[Nu]"}], "+", 
             RowBox[{"s0", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "-", "el"}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "G3", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "-", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}], "-", 
             RowBox[{"I", "*", "el"}]}], ",", 
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "-", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}]}], "}"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "*", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], "*", 
                RowBox[{"Pi", "/", "4"}]}], "]"}]}], "-", 
             RowBox[{"I", "*", 
              RowBox[{"Abs", "[", 
               RowBox[{"s0", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"s0", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"bigN", ",", "bigN", ",", "bigN", ",", "bigN", ",", 
         RowBox[{"bigN", "*", "4"}], ",", "bigN", ",", "bigN", ",", "bigN", 
         ",", "bigN"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Jadapt", "[", "1", "]"}], "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Adapt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Jsamp", "[", "1", "]"}], "[", 
         RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
      RowBox[{
       RowBox[{"J", "[", "1", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.798306475310475*^9, 3.798306576700044*^9}, {
   3.7983066085144477`*^9, 3.7983066284858046`*^9}, {3.79830666408398*^9, 
   3.798306684086971*^9}, 3.798306825977499*^9, {3.7983069561473536`*^9, 
   3.7983069923021913`*^9}, 3.7983070863040113`*^9, {3.7983071228934355`*^9, 
   3.798307160454026*^9}, {3.798307251318612*^9, 3.798307254594817*^9}, {
   3.798307317780735*^9, 3.798307321711047*^9}, {3.7983074387086973`*^9, 
   3.7983074629719753`*^9}, {3.7983076734663644`*^9, 3.798307676566191*^9}, {
   3.798309071359389*^9, 3.7983090748438396`*^9}, {3.7983091367696133`*^9, 
   3.7983091370327373`*^9}, {3.798309411094526*^9, 3.7983094152569466`*^9}, {
   3.7983100223938956`*^9, 3.7983100245290575`*^9}, 3.7983100664700403`*^9, {
   3.7983101559181128`*^9, 3.798310163609605*^9}, {3.7983102556478424`*^9, 
   3.798310318869627*^9}, 3.7983104096622787`*^9, {3.7983111713795075`*^9, 
   3.798311176211666*^9}, {3.7983124239530354`*^9, 3.7983124446789455`*^9}, {
   3.7983124810405827`*^9, 3.7983124975266647`*^9}, 3.7983125306663246`*^9, {
   3.798312563904667*^9, 3.798312587080225*^9}, {3.7983126382569914`*^9, 
   3.798312645611608*^9}, {3.79831272050176*^9, 3.798312722107554*^9}, {
   3.7983127558401394`*^9, 3.7983128750966377`*^9}, {3.79832941611514*^9, 
   3.798329421653553*^9}, {3.79833382048467*^9, 3.798333828663293*^9}, {
   3.7983340091015873`*^9, 3.7983340109103403`*^9}, {3.7983346674256115`*^9, 
   3.7983346688246307`*^9}, {3.7983351912336674`*^9, 
   3.7983352039470315`*^9}, {3.7983355278718433`*^9, 3.798335529745164*^9}, {
   3.798336114809575*^9, 3.7983361510568047`*^9}, {3.7983362835616903`*^9, 
   3.7983363576987863`*^9}, {3.798336692408046*^9, 3.798336700161841*^9}, {
   3.7983722406034937`*^9, 3.798372246728168*^9}, 3.8206901442950087`*^9, {
   3.8214006720748744`*^9, 3.821400675531141*^9}, {3.8214077715908737`*^9, 
   3.8214077759741397`*^9}, {3.821409145213784*^9, 3.821409147384054*^9}, {
   3.824395041779254*^9, 3.824395055031674*^9}, {3.8243951315613995`*^9, 
   3.8243951546490684`*^9}, {3.8243951885371037`*^9, 3.824395313643235*^9}, {
   3.8243953451396356`*^9, 3.8243954326976924`*^9}, {3.824395463521759*^9, 
   3.8243955180831437`*^9}, {3.8243957569484673`*^9, 3.824395841435116*^9}, {
   3.8244024564343505`*^9, 3.8244024858089314`*^9}, {3.8255312664101725`*^9, 
   3.825531336952118*^9}, {3.8255313778736076`*^9, 3.825531381286935*^9}, {
   3.826120838845874*^9, 3.8261208871397705`*^9}, {3.8270141008872147`*^9, 
   3.827014109038349*^9}},ExpressionUUID->"b8c6031a-b82b-4f28-92b9-\
f4d91bc4d5c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Region 2: Large t", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5378236069191504`*^9, 3.537823619029093*^9}, {
  3.5656307009522*^9, 
  3.5656307035861998`*^9}},ExpressionUUID->"2533f437-0781-45be-86b6-\
0a7c08935c96"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DDI", "[", 
      RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Im", "[", "k", "]"}], " ", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       RowBox[{"DDs", "[", 
        RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], ",", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"used", " ", "for", " ", "lensing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Tau]", "[", "k_", "]"}], ":=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"cc", "[", 
         RowBox[{"gam", "[", 
          RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}], "+", 
       RowBox[{"Gam", "[", "k", "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"cc", "[", 
         RowBox[{"Gam", "[", 
          RowBox[{"cc", "[", "k", "]"}], "]"}], "]"}]}], "+", 
       RowBox[{"gam", "[", "k", "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"startift", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", "ift", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"dom", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Truncate", "[", "globalTol", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Log", "[", 
             RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "el"}], ",", "el"}], "}"}], "]"}], ",", "50"}], 
          "}"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<this is dom\>\"", ",", "dom"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{"dom", "\[Equal]", 
         RowBox[{
          RowBox[{"{", "}"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ift", "[", "k0_", "]"}], ":=", 
          RowBox[{"Fun", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"0", "*", "#"}], "&"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "el"}], ",", "k0"}], "}"}], "//", "Line"}], ",", 
            "50"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ift", "[", "k0_", "]"}], ":=", 
          RowBox[{
           RowBox[{"ift", "[", "k0", "]"}], "=", 
           RowBox[{"Fun", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Log", "[", 
               RowBox[{"\[Tau]", "[", "#", "]"}], "]"}], "&"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"LeftEndpoint", "[", "dom", "]"}], ",", "k0"}], "}"}],
               "//", "Line"}], ",", "50"}], "]"}]}]}], ";"}]}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]t", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", 
    RowBox[{"s_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{"s", ",", 
       RowBox[{"ift", "[", 
        RowBox[{
         RowBox[{"-", "x"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", " ", "t"}], ")"}]}], "]"}], ",", "k"}], "]"}], "//", 
     "Exp"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]t", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cauchy", "[", 
      RowBox[{
       RowBox[{"ift", "[", 
        RowBox[{
         RowBox[{"-", "x"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", " ", "t"}], ")"}]}], "]"}], ",", "k"}], "]"}], "//", 
     "Exp"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]t", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z__", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        RowBox[{"\[Delta]t", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "0"},
      {"0", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"\[Delta]t", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}]]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]tin", "[", "t__", "]"}], "[", "z__", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"\[Delta]t", "[", "t", "]"}], "[", "z", "]"}]}], "0"},
      {"0", 
       RowBox[{
        RowBox[{"\[Delta]t", "[", "t", "]"}], "[", "z", "]"}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]ts", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]t", "[", 
     RowBox[{"x", ",", "t"}], "]"}], "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalPhi]tins", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]tin", "[", 
     RowBox[{"x", ",", "t"}], "]"}], "[", 
    RowBox[{
     RowBox[{"z", "/", 
      RowBox[{"Sqrt", "[", "t", "]"}]}], "-", 
     RowBox[{"x", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "t"}], ")"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxRads", "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", "*", 
        RowBox[{"Sqrt", "[", "t", "]"}]}], ",", "100"}], "]"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", "2", "]"}], "\[Nu]", " ", "*", 
        RowBox[{
         RowBox[{"Sqrt", "[", "t", "]"}], "/", "2"}]}], ",", "1"}], "]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J", "[", "2", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Jumps", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ls", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ls", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Us", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Us", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"G3s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ms", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ms", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ps", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"G1s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ps", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DDI", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DDs", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Us", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Lins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"G3s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ms", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Lins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"G1s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalPhi]ts", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"G3s", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"\[CapitalPhi]tins", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Domains", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "-", " ", 
             RowBox[{"I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], "I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "I", " ", 
             RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{"I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"3", "I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"3", "I", " ", 
             RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}]}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}], ",", 
            RowBox[{
             RowBox[{"el", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "-", 
             RowBox[{"2", " ", "I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}]}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}], ",", 
            RowBox[{
             RowBox[{"el", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "+", 
             RowBox[{"2", " ", "I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{"3", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"3", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", " ", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MaxRads", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
              RowBox[{"2", "*", "\[Nu]", "*", 
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", " ", 
                  RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}]}], "}"}], 
            "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "*", "\[Nu]", "*", 
             RowBox[{"Sqrt", "[", "2", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"2", "*", "\[Nu]", "*", 
              RowBox[{"Sqrt", "[", "2", "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], "+", 
             RowBox[{"I", "*", "el"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MaxRads", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
              RowBox[{"2", "*", "\[Nu]", "*", 
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "I"}], " ", 
                  RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}]}], "}"}], 
            "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "*", "\[Nu]", "*", 
             RowBox[{"Sqrt", "[", "2", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", 
                RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"2", "*", "\[Nu]", "*", 
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], "-", 
             RowBox[{"I", "*", "el"}]}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NumPts", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"smallN", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "14"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "13", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "14", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jsamp", "[", "2", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Jumps", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Lssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Lssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Ussamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Ussamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"G3ssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Mssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Mssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Pssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"G1ssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Pssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"DDssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"DDssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Ussamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Linssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"G3ssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], ".", 
           RowBox[{
            RowBox[{"Mssamp", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}]}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Linssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"G1ssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"G3ssamp", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "#", "]"}], "&"}]}], "}"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Domains", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "-", " ", 
             RowBox[{"I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], "I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "3"}], "I", " ", 
             RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "el"}], " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "+", " ", 
             RowBox[{"I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"3", "I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"MaxRads", "[", 
            RowBox[{"x", ",", "t"}], "]"}], 
           RowBox[{"Exp", "[", 
            RowBox[{"3", "I", " ", 
             RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}]}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}], ",", 
            RowBox[{
             RowBox[{"el", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "-", 
             RowBox[{"2", " ", "I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"MaxRads", "[", 
                RowBox[{"x", ",", "t"}], "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}]}], "}"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"MaxRads", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4."}]}], "]"}], "*", "2"}], ",", 
            RowBox[{
             RowBox[{"el", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "+", 
             RowBox[{"2", " ", "I", " ", "\[Nu]", " ", 
              RowBox[{"Sqrt", "[", "t", "]"}]}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{"3", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"3", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", " ", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "I"}], " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "3"}], " ", "I", " ", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}]}], "}"}], "*", 
           RowBox[{
            RowBox[{"MaxRads", "[", 
             RowBox[{"x", ",", "t"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MaxRads", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
              RowBox[{"2", "*", "\[Nu]", "*", 
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Exp", "[", 
                 RowBox[{"I", " ", 
                  RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}]}], "}"}], 
            "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "*", "\[Nu]", "*", 
             RowBox[{"Sqrt", "[", "2", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", " ", 
                RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"2", "*", "\[Nu]", "*", 
              RowBox[{"Sqrt", "[", "2", "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], "+", 
             RowBox[{"I", "*", "el"}]}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"MaxRads", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}]}], ",", 
              RowBox[{"2", "*", "\[Nu]", "*", 
               RowBox[{"Sqrt", "[", "2", "]"}], "*", 
               RowBox[{"(", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "I"}], " ", 
                  RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}]}], "}"}], 
            "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "*", "\[Nu]", "*", 
             RowBox[{"Sqrt", "[", "2", "]"}], "*", 
             RowBox[{"(", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "I"}], " ", 
                RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"2", "*", "\[Nu]", "*", 
              RowBox[{"(", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "I"}], " ", 
                 RowBox[{"\[Pi]", "/", "4."}]}], "]"}], ")"}]}], "-", 
             RowBox[{"I", "*", "el"}]}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NumPts", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"smallN", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "14"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "13", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"NumPts", "[", 
        RowBox[{"[", "14", "]"}], "]"}], "=", "bigN"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Jumps", ",", "Domains", ",", "NumPts"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Jadapt", "[", "2", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Adapt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Jsamp", "[", "2", "]"}], "[", 
       RowBox[{"x", ",", "t"}], "]"}], ",", "globalTol"}], "]"}], "[", 
    RowBox[{
     RowBox[{"J", "[", "2", "]"}], "[", 
     RowBox[{"x", ",", "t"}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.537823686437846*^9, 3.537823759286895*^9}, 
   3.5407610818094*^9, {3.540842388424041*^9, 3.540842390117072*^9}, {
   3.541861872987379*^9, 3.5418618934527607`*^9}, {3.5656296622852*^9, 
   3.5656296673232*^9}, {3.5656299847592*^9, 3.5656302347792*^9}, {
   3.5656303393562*^9, 3.5656303396532*^9}, {3.5656303719302*^9, 
   3.5656304390572*^9}, {3.5656307288932*^9, 3.5656307325512*^9}, {
   3.5656308164342003`*^9, 3.5656308820222*^9}, {3.5656309179982*^9, 
   3.5656309243332*^9}, {3.5656310882972*^9, 3.5656312752002*^9}, {
   3.5656313309462*^9, 3.5656314091772003`*^9}, {3.5656316170811996`*^9, 
   3.5656316182111998`*^9}, {3.5656317798342*^9, 3.5656318154072*^9}, 
   3.5656318858171997`*^9, {3.5656372521222*^9, 3.5656372585842*^9}, {
   3.5656372950052*^9, 3.5656372959932003`*^9}, {3.5656398476602*^9, 
   3.5656398616612*^9}, {3.5656411402262*^9, 3.5656411477642*^9}, 
   3.5656412028792*^9, {3.5656415538431997`*^9, 3.5656416110102*^9}, {
   3.5656542369542*^9, 3.5656542447452*^9}, {3.5656584703272*^9, 
   3.5656584795872*^9}, {3.5656588940092*^9, 3.5656589494091997`*^9}, {
   3.5657100848472*^9, 3.5657101201442003`*^9}, {3.5657101507042*^9, 
   3.5657101995982*^9}, {3.5657528650822*^9, 3.5657528721812*^9}, {
   3.5657543897637043`*^9, 3.565754390366497*^9}, {3.5657607080606127`*^9, 
   3.565760756787821*^9}, {3.820689182523707*^9, 3.8206892134842396`*^9}, {
   3.820689260613617*^9, 3.820689261769588*^9}, {3.8206893492146797`*^9, 
   3.8206893512589054`*^9}, {3.8206893839304676`*^9, 
   3.8206894022387896`*^9}, {3.820689435904755*^9, 3.8206894691186523`*^9}, {
   3.8206896360931516`*^9, 3.820689654034145*^9}, {3.8206897033918304`*^9, 
   3.820689795710323*^9}, {3.8206898260771227`*^9, 3.820689827912236*^9}, {
   3.82069012206102*^9, 3.820690131734935*^9}, {3.820690162316432*^9, 
   3.8206901858628073`*^9}, {3.820691166935909*^9, 3.8206912077386436`*^9}, {
   3.8206917368887124`*^9, 3.820691765812927*^9}, {3.8206918232565346`*^9, 
   3.8206918268327665`*^9}, {3.820691879503639*^9, 3.820691896343913*^9}, {
   3.82069214183539*^9, 3.820692142946602*^9}, {3.820692691900509*^9, 
   3.8206927028930264`*^9}, {3.8206990911486073`*^9, 
   3.8206992018358045`*^9}, {3.8206993096277666`*^9, 3.82069935893839*^9}, {
   3.8206998069255104`*^9, 3.8206998851969976`*^9}, {3.8206999839773445`*^9, 
   3.820699985066804*^9}, 3.820701375148741*^9, 3.820701516781642*^9, {
   3.82070903313196*^9, 3.8207090376528406`*^9}, {3.820709578064535*^9, 
   3.820709589554521*^9}, {3.820712435281253*^9, 3.8207124617359695`*^9}, {
   3.8207125039134283`*^9, 3.8207125168317695`*^9}, {3.8207125471284385`*^9, 
   3.8207125593715296`*^9}, {3.8207160747663803`*^9, 3.820716101117283*^9}, {
   3.8207189493062143`*^9, 3.820718950298662*^9}, {3.8207191267619376`*^9, 
   3.8207191276728115`*^9}, {3.824354890961108*^9, 3.8243549594565783`*^9}, {
   3.8243552745687423`*^9, 3.8243552883924446`*^9}, {3.824355381583544*^9, 
   3.8243553819705935`*^9}, {3.8243555765442142`*^9, 3.824355579649167*^9}, {
   3.8243557199181833`*^9, 3.8243557231619406`*^9}, {3.824355794070041*^9, 
   3.8243557947880774`*^9}, {3.824355943763605*^9, 3.82435597775317*^9}, {
   3.824404151543604*^9, 3.8244041626095185`*^9}, {3.824404226834388*^9, 
   3.824404418635599*^9}, {3.8244044945602007`*^9, 3.8244044946895533`*^9}, 
   3.8244067350707293`*^9, {3.8244068238041506`*^9, 3.824406845168343*^9}, {
   3.8244069167337713`*^9, 3.824406947180221*^9}, {3.8244070010519323`*^9, 
   3.824407004741682*^9}, 3.8244073619074354`*^9, 3.824412776978037*^9, {
   3.824412823068015*^9, 3.8244128463509426`*^9}, 3.824413121820388*^9, 
   3.8244137158655705`*^9, {3.82441413984342*^9, 
   3.8244142284877305`*^9}},ExpressionUUID->"f195008e-39ec-4f4c-a3d8-\
3c85cfc3acaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Soliton Contours (currently computing poles from a(k) only, no poles from \
d(k))\
\>", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.540663327743*^9, 3.5406633359230003`*^9}, {
  3.8238661360033865`*^9, 
  3.8238661830338726`*^9}},ExpressionUUID->"16016f48-5b4a-49fb-908f-\
f42f9f62211d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InvScale", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Sqrt", "[", "t", "]"}], 
    RowBox[{"(", 
     RowBox[{"k", "+", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"4", "t"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Scaling", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"k", "/", 
     RowBox[{"Sqrt", "[", "t", "]"}]}], " ", "-", 
    RowBox[{"x", "/", 
     RowBox[{"(", 
      RowBox[{"4", "t"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tn", "[", 
      RowBox[{"+", "1"}], "]"}], "[", 
     RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", "]"}],
    ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0"},
      {
       RowBox[{
        RowBox[{"-", "c"}], " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"\[Theta]", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"z", "-", "a"}], ")"}]}]}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tn", "[", 
      RowBox[{"-", "1"}], "]"}], "[", 
     RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", "]"}],
    ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"cc", "[", 
         RowBox[{
          RowBox[{"-", "c"}], " ", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"cc", "[", "z", "]"}], "-", "a"}], ")"}]}]}], "]"}]}]},
      {
       RowBox[{" ", "0"}], "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sn", "[", 
      RowBox[{"+", "1"}], "]"}], "[", 
     RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", "]"}],
    ":=", 
   RowBox[{"(", GridBox[{
      {"1", 
       RowBox[{
        FractionBox[
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"z", "-", "a"}], ")"}]}], "c"], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"\[Theta]", "[", 
            RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}]}], "]"}]}]},
      {"0", "1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sn", "[", 
       RowBox[{"-", "1"}], "]"}], "[", 
      RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", 
     "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {"1", "0"},
       {
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"cc", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"cc", "[", "z", "]"}], "-", "a"}], ")"}]}], "c"], "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}]}], "]"}]}], 
          "]"}]}], "1"}
      }], ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "  ", 
   RowBox[{
    RowBox[{"a", " ", "center", "   ", "r", "  ", "radius"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"+", "1"}], " ", "is", " ", "in", " ", "upper"}], " ", "-", 
     RowBox[{"1", " ", "is", " ", "in", " ", "lower"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ContourArrayn", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "r_", ",", "a_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Arc", "[", 
      RowBox[{"a", ",", "r", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Pi"}], "}"}]}], "]"}], ",", 
     RowBox[{"Arc", "[", 
      RowBox[{"a", ",", "r", ",", 
       RowBox[{"{", 
        RowBox[{"Pi", ",", 
         RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ContourArrayn", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "r_", ",", "a_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Arc", "[", 
       RowBox[{
        RowBox[{"a", "//", "cc"}], ",", "r", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "Pi"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Arc", "[", 
       RowBox[{
        RowBox[{"a", "//", "cc"}], ",", "r", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Pi"}], ",", 
          RowBox[{
           RowBox[{"-", "2"}], "Pi"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"+", "1"}], "]"}], "[", 
     RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", "]"}],
    ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Tn", "[", 
      RowBox[{"+", "1"}], "]"}], "[", 
     RowBox[{"x", ",", "t", ",", "a", ",", "c"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Scaling", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"-", "1"}], "]"}], "[", 
     RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", "]"}],
    ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Tn", "[", 
      RowBox[{"-", "1"}], "]"}], "[", 
     RowBox[{"x", ",", "t", ",", "a", ",", "c"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Scaling", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"+", "1"}], "]"}], "[", 
     RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", "]"}],
    ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sn", "[", 
      RowBox[{"+", "1"}], "]"}], "[", 
     RowBox[{"x", ",", "t", ",", "a", ",", "c"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Scaling", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"-", "1"}], "]"}], "[", 
     RowBox[{"x_", ",", "t_", ",", "a_", ",", "c_"}], "]"}], "[", "z_", "]"}],
    ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sn", "[", 
      RowBox[{"-", "1"}], "]"}], "[", 
     RowBox[{"x", ",", "t", ",", "a", ",", "c"}], "]"}], "[", 
    RowBox[{
     RowBox[{"Scaling", "[", 
      RowBox[{"x", ",", "t"}], "]"}], "[", "z", "]"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.540663356863*^9, 3.5406634779230003`*^9}, {
   3.540663514553*^9, 3.540663559523*^9}, {3.5406636903546*^9, 
   3.5406638634946003`*^9}, {3.5406639640346003`*^9, 3.5406640204646*^9}, {
   3.5406641670945997`*^9, 3.5406641983646*^9}, {3.5406642496246*^9, 
   3.5406643193246*^9}, {3.5406643716646*^9, 3.5406643812946*^9}, {
   3.5406644820945997`*^9, 3.5406645177646*^9}, 3.5406645531018*^9, {
   3.5406646915018*^9, 3.5406648196538*^9}, {3.540668185589525*^9, 
   3.540668263873556*^9}, {3.54066831648492*^9, 3.5406684168554087`*^9}, {
   3.54066844904218*^9, 3.540668517764138*^9}, {3.540668618759264*^9, 
   3.540668717261815*^9}, {3.540669354468211*^9, 3.540669359280778*^9}, {
   3.540669502128993*^9, 3.5406695823656063`*^9}, {3.54066961440208*^9, 
   3.540669662983015*^9}, {3.54067189344142*^9, 3.540671925802581*^9}, {
   3.5406731652249823`*^9, 3.5406732638866568`*^9}, {3.5406741647813997`*^9, 
   3.5406741678613997`*^9}, {3.5406741991954*^9, 3.5406742011074*^9}, {
   3.5406826199754*^9, 3.5406826249944*^9}, {3.5406834491594*^9, 
   3.5406834534044*^9}, {3.5406835138184*^9, 3.5406835198314*^9}, {
   3.5406839573473997`*^9, 3.5406839578014*^9}, {3.5406875816144*^9, 
   3.5406875942444*^9}, {3.5406893661443996`*^9, 3.5406893835144*^9}, {
   3.5406894255744*^9, 3.5406894318104*^9}, {3.5407264300074*^9, 
   3.5407264358624*^9}, {3.540735266297641*^9, 3.54073530536005*^9}, {
   3.540735803202181*^9, 3.540735809259849*^9}, {3.540736099083493*^9, 
   3.540736100324586*^9}, {3.540737377234128*^9, 3.540737392702014*^9}, {
   3.540738683107176*^9, 3.540738743177516*^9}, {3.540738779460793*^9, 
   3.540738786570944*^9}, {3.540740941006283*^9, 3.540740955773658*^9}, {
   3.5407412010663157`*^9, 3.540741317799933*^9}, {3.5407610939393997`*^9, 
   3.5407612605094*^9}, {3.5407620108694*^9, 3.5407620122693996`*^9}, {
   3.5407621572894*^9, 3.5407621698494*^9}, {3.5407622649393997`*^9, 
   3.5407622724894*^9}, 3.5407625509994*^9, {3.5407640913234*^9, 
   3.5407640999234*^9}, {3.5407690321454*^9, 3.5407690325254*^9}, {
   3.5409028140464*^9, 3.5409028143864*^9}, {3.5656323663862*^9, 
   3.5656324283422003`*^9}, {3.5656324906851997`*^9, 
   3.5656325725522003`*^9}, {3.5656573568952*^9, 3.5656574370852003`*^9}, {
   3.5657050454421997`*^9, 3.5657051195582*^9}, {3.5657052135692*^9, 
   3.5657052213722*^9}, {3.5657053117812*^9, 3.5657053210292*^9}, {
   3.824304996366101*^9, 3.824305011258185*^9}, {3.8243446267958565`*^9, 
   3.8243446422265177`*^9}},ExpressionUUID->"453ca672-a7ed-4b51-a2bc-\
7e1fc02680d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ContourArray", "[", 
    RowBox[{
     RowBox[{"+", "1"}], ",", "r_", ",", "a_", ",", "x_", ",", "t_"}], "]"}], 
   ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Arc", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"InvScale", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}], ",", 
       RowBox[{"r", "*", 
        RowBox[{"Sqrt", "[", "t", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Pi"}], "}"}]}], "]"}], ",", 
     RowBox[{"Arc", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"InvScale", "[", 
         RowBox[{"x", ",", "t"}], "]"}], "[", "a", "]"}], ",", 
       RowBox[{"r", "*", 
        RowBox[{"Sqrt", "[", "t", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Pi", ",", 
         RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ContourArray", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "r_", ",", "a_", ",", "x_", ",", "t_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Arc", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"InvScale", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"a", "//", "cc"}], "]"}], ",", 
        RowBox[{"r", "*", 
         RowBox[{"Sqrt", "[", "t", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", "Pi"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Arc", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"InvScale", "[", 
          RowBox[{"x", ",", "t"}], "]"}], "[", 
         RowBox[{"a", "//", "cc"}], "]"}], ",", 
        RowBox[{"r", "*", 
         RowBox[{"Sqrt", "[", "t", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Pi"}], ",", 
          RowBox[{
           RowBox[{"-", "2"}], "Pi"}]}], "}"}]}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PoleListn", "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", "i", ",", "Domain", ",", "Jumps", ",", "Points"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Domain", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Jumps", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Points", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "a", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "globalTol"}], ">", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"c", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "t"}], "]"}], "[", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}]}], "&&", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"c", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], 
              RowBox[{"Exp", "[", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{"\[Theta]", "[", 
                  RowBox[{"x", ",", "t"}], "]"}], "[", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], ">", 
             " ", "globalTol"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"c", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], 
                RowBox[{"Exp", "[", 
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "t"}], "]"}], "[", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
               ">", "expconst"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Jumps", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sn", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Sn", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Jumps", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sn", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Sn", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"flag", "=", "\"\<pos\>\""}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Jumps", " ", "=", " ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Tn", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Tn", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Jumps", " ", "=", " ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Tn", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Tn", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"flag", "=", "\"\<neg\>\""}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Domain", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"Domain", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"ContourArrayn", "[", 
                  RowBox[{
                   RowBox[{"+", "1"}], ",", "rad", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ContourArrayn", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "rad", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Points", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"Points", ",", 
               RowBox[{"{", 
                RowBox[{
                "smallN", ",", "smallN", ",", "smallN", ",", "smallN"}], 
                "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Jumps", ",", "Domain", ",", "Points"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PoleList", "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", "i", ",", "Domain", ",", "Jumps", ",", "Points"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Domain", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Jumps", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Points", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "a", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "/", "tol"}], " ", ">", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"c", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"Re", "[", 
               RowBox[{
                RowBox[{"\[Theta]", "[", 
                 RowBox[{"x", ",", "t"}], "]"}], "[", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], ">", 
            " ", "tol"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"c", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], 
                RowBox[{"Exp", "[", 
                 RowBox[{"Re", "[", 
                  RowBox[{
                   RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "t"}], "]"}], "[", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
               ">", "expconst"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Jumps", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Sn", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Jumps", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Sn", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"flag", "=", "\"\<pos\>\""}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Jumps", " ", "=", " ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Tn", "[", 
                    RowBox[{"+", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Jumps", " ", "=", " ", 
                RowBox[{"Join", "[", 
                 RowBox[{"Jumps", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Tn", "[", 
                    RowBox[{"-", "1"}], "]"}], "[", 
                    RowBox[{"x", ",", "t", ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "}"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"flag", "=", "\"\<neg\>\""}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Domain", "=", " ", 
             RowBox[{"Join", "[", 
              RowBox[{"Domain", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"ContourArray", "[", 
                  RowBox[{
                   RowBox[{"+", "1"}], ",", "rad", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"ContourArray", "[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "rad", ",", 
                   RowBox[{"a", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Points", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"Points", ",", 
               RowBox[{"{", 
                RowBox[{
                "smallN", ",", "smallN", ",", "smallN", ",", "smallN"}], 
                "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Jumps", ",", "Domain", ",", "Points"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.540663356863*^9, 3.5406634779230003`*^9}, {
   3.540663514553*^9, 3.540663559523*^9}, {3.5406636903546*^9, 
   3.5406638634946003`*^9}, {3.5406639640346003`*^9, 3.5406640204646*^9}, {
   3.5406641670945997`*^9, 3.5406641983646*^9}, {3.5406642496246*^9, 
   3.5406643193246*^9}, {3.5406643716646*^9, 3.5406643812946*^9}, {
   3.5406644820945997`*^9, 3.5406645177646*^9}, 3.5406645531018*^9, {
   3.5406646915018*^9, 3.5406648196538*^9}, {3.540668185589525*^9, 
   3.540668263873556*^9}, {3.54066831648492*^9, 3.5406684168554087`*^9}, {
   3.54066844904218*^9, 3.540668517764138*^9}, {3.540668618759264*^9, 
   3.540668717261815*^9}, {3.540669354468211*^9, 3.540669359280778*^9}, {
   3.540669502128993*^9, 3.5406695823656063`*^9}, {3.54066961440208*^9, 
   3.540669662983015*^9}, {3.54067189344142*^9, 3.540671925802581*^9}, {
   3.5406731652249823`*^9, 3.5406732638866568`*^9}, {3.5406741647813997`*^9, 
   3.5406741678613997`*^9}, {3.5406741991954*^9, 3.5406742011074*^9}, {
   3.5406826199754*^9, 3.5406826249944*^9}, {3.5406834491594*^9, 
   3.5406834534044*^9}, {3.5406835138184*^9, 3.5406835198314*^9}, {
   3.5406839573473997`*^9, 3.5406839578014*^9}, {3.5406875816144*^9, 
   3.5406875942444*^9}, {3.5406893661443996`*^9, 3.5406893835144*^9}, {
   3.5406894255744*^9, 3.5406894318104*^9}, {3.5407264300074*^9, 
   3.5407264358624*^9}, {3.540735266297641*^9, 3.54073530536005*^9}, {
   3.540735803202181*^9, 3.540735809259849*^9}, {3.540736099083493*^9, 
   3.540736100324586*^9}, {3.540737377234128*^9, 3.540737392702014*^9}, {
   3.540738683107176*^9, 3.540738743177516*^9}, {3.540738779460793*^9, 
   3.540738786570944*^9}, {3.540740941006283*^9, 3.540740955773658*^9}, {
   3.5407412010663157`*^9, 3.540741317799933*^9}, {3.5407610939393997`*^9, 
   3.5407612605094*^9}, {3.5407620108694*^9, 3.5407620122693996`*^9}, {
   3.5407621572894*^9, 3.5407621698494*^9}, {3.5407622649393997`*^9, 
   3.5407622724894*^9}, {3.5407625509994*^9, 3.5407625539294*^9}, 
   3.5407628404994*^9, {3.5407631811373997`*^9, 3.5407631847774*^9}, {
   3.5407638581274*^9, 3.5407638642874002`*^9}, {3.5407639867474003`*^9, 
   3.5407639944874*^9}, {3.5409021567874002`*^9, 3.5409021699004*^9}, {
   3.5409024156774*^9, 3.5409024266174*^9}, {3.5418962414278*^9, 
   3.5418962696868*^9}, {3.5656325796591997`*^9, 3.5656326739922*^9}, {
   3.5656408345022*^9, 3.5656408553482*^9}, {3.5656409296572*^9, 
   3.5656409311712*^9}, {3.5656410927402*^9, 3.5656410944161997`*^9}, {
   3.5656569424672003`*^9, 3.5656569628112*^9}, {3.5656570735601997`*^9, 
   3.5656570739122*^9}, {3.5656574485282*^9, 3.5656574568632*^9}, {
   3.5656575081242*^9, 3.5656575201902*^9}, 3.5657051296362*^9, {
   3.5657051636382*^9, 3.5657051928532*^9}, {3.5657052255741997`*^9, 
   3.5657052641122*^9}, {3.5657053266972*^9, 3.5657053442622004`*^9}, {
   3.5657055039852*^9, 3.5657056261212*^9}, {3.5657056569862003`*^9, 
   3.5657058077992*^9}, 3.5657058821342*^9, {3.5657059386932*^9, 
   3.5657060435632*^9}, {3.5657299619792*^9, 3.5657300165132*^9}, {
   3.5657300566001997`*^9, 3.5657300661042*^9}, {3.5657301133512*^9, 
   3.5657301772592*^9}, {3.5657304984102*^9, 3.5657305008901997`*^9}, {
   3.5657309373652*^9, 3.5657309378262*^9}, {3.5657310008402*^9, 
   3.5657310015192003`*^9}, {3.5657311318742*^9, 3.5657311407702*^9}, {
   3.5657311733612003`*^9, 3.5657311765502*^9}, {3.5657312242911997`*^9, 
   3.5657312298772*^9}, {3.5657312702562*^9, 3.5657312727232*^9}, {
   3.5657319452152*^9, 3.5657319568372*^9}, 3.5657319998802*^9, {
   3.5657320713552*^9, 3.5657321651472*^9}, 3.5657321965702*^9, {
   3.5657322322392*^9, 3.5657322623932*^9}, {3.5657325516442003`*^9, 
   3.5657325518982*^9}, {3.8243441932155323`*^9, 3.8243442087593703`*^9}, 
   3.8243444127503757`*^9, {3.824344558471484*^9, 3.8243445586458473`*^9}, {
   3.8243447725824885`*^9, 3.8243447732381744`*^9}, {3.8243448247280135`*^9, 
   3.8243448249097605`*^9}},ExpressionUUID->"1b401ad1-8983-40dc-a9f4-\
da1ab5e5f04f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Add Poles and Choose", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5656330942762003`*^9, 3.5656330964582*^9}, {
  3.565800226807107*^9, 
  3.565800228918049*^9}},ExpressionUUID->"2b3edd14-5242-423f-bdd6-\
dd70b29ae6d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DomainIntegrate", "[", "0.", "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tcrit", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NLS", "[", "i_", "]"}], "[", 
    RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "scale", ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2", ",", 
       "\[CapitalPhi]", ",", "out", ",", "t1", ",", "t2", ",", "t3", ",", 
       "t4", ",", "poles"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "2"}], ",", 
        RowBox[{"scale", "=", "True"}], ",", 
        RowBox[{"scale", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"RHSolved", "//", "Clear"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RHSolved", "[", "X_", "]"}], ":=", 
       RowBox[{
        RowBox[{"RHSolved", "[", "X", "]"}], "=", 
        RowBox[{"RHSolve", "[", "X", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RHSolved", "[", 
        RowBox[{"{", "}"}], "]"}], ":=", "0."}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"RHSolution", "[", "X_", "]"}], "[", "z_", "]"}], ":=", 
       RowBox[{
        RowBox[{"Cauchy", "[", 
         RowBox[{
          RowBox[{"X", "//", "RHSolved"}], ",", "z"}], "]"}], "+", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"scale", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t1", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"rhp1", "=", 
             RowBox[{
              RowBox[{"ConjugateList", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Jadapt", "[", "i", "]"}], "[", 
                 RowBox[{"x", ",", "t"}], "]"}], ",", 
                RowBox[{"Q", "[", 
                 RowBox[{"x", ",", "t"}], "]"}]}], "]"}], "//", 
              "MakeListFun"}]}], ";"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t2", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"RHSolved", "[", "rhp1", "]"}], ";"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPhi]1", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"RHSolution", "[", "rhp1", "]"}], "[", 
            RowBox[{
             RowBox[{"InvScale", "[", 
              RowBox[{"x", ",", "t"}], "]"}], "[", "k", "]"}], "]"}], "//", 
           "Inverse"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t1", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"rhp1", "=", 
             RowBox[{
              RowBox[{"ConjugateList", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Jadapt", "[", "i", "]"}], "[", 
                 RowBox[{"x", ",", "t"}], "]"}], ",", 
                RowBox[{"Qn", "[", 
                 RowBox[{"x", ",", "t"}], "]"}]}], "]"}], "//", 
              "MakeListFun"}]}], ";"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t2", "=", 
          RowBox[{"Timing", "[", 
           RowBox[{
            RowBox[{"RHSolved", "[", "rhp1", "]"}], ";"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPhi]1", "[", "k_", "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"RHSolution", "[", "rhp1", "]"}], "[", "k", "]"}], "//", 
           "Inverse"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"domainOutput", " ", "=", " ", 
       RowBox[{"DomainPlot", "[", "rhp1", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"rhp2", "=", " ", 
       RowBox[{"ConjugateList", "[", 
        RowBox[{
         RowBox[{"PoleListn", "[", 
          RowBox[{"x", ",", "t"}], "]"}], ",", 
         RowBox[{"Qn", "[", 
          RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"no", " ", "scale"}], ",", " ", "nah", ",", " ", 
        RowBox[{
        "looks", " ", "like", " ", "pole", " ", "contours", " ", "are", " ", 
         "all", " ", "not", " ", "scaled"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rhp2", "=", " ", 
          RowBox[{"ConjugateList", "[", 
           RowBox[{"rhp2", ",", 
            RowBox[{"\[CapitalPhi]tin", "[", 
             RowBox[{"x", ",", "t"}], "]"}]}], "]"}]}], ";"}]}], 
       "                   ", 
       RowBox[{"(*", " ", 
        RowBox[{"scale", ",", " ", 
         RowBox[{
         "nah", " ", "this", " ", "is", " ", "not", " ", "scale", " ", "but", 
          " ", "remove", " ", "the", " ", "contour", " ", "on", " ", "the", 
          " ", "negative", " ", "real"}]}], "*)"}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"t3", "=", 
       RowBox[{"Timing", "[", 
        RowBox[{
         RowBox[{"rhp2", "=", " ", 
          RowBox[{
           RowBox[{"ConjugateList", "[", 
            RowBox[{"rhp2", ",", "\[CapitalPhi]1"}], "]"}], "//", 
           "MakeListFun"}]}], ";"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t4", "=", 
       RowBox[{"Timing", "[", 
        RowBox[{
         RowBox[{"RHSolved", "[", "rhp2", "]"}], ";"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]2", " ", "=", " ", 
       RowBox[{"RHSolution", "[", "rhp2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalPhi]", "[", "k_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"RHSolution", "[", "rhp2", "]"}], "[", "k", "]"}], ".", 
        RowBox[{
         RowBox[{"RHSolution", "[", "rhp1", "]"}], "[", "k", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"DomainIntegrate", "[", 
              RowBox[{"RHSolved", "[", "rhp1", "]"}], "]"}], " ", 
             RowBox[{"If", "[", 
              RowBox[{"scale", ",", 
               RowBox[{"1", "/", 
                RowBox[{"Sqrt", "[", "t", "]"}]}], ",", "1"}], "]"}]}], "+", 
            RowBox[{"DomainIntegrate", "[", 
             RowBox[{"RHSolved", "[", "rhp2", "]"}], "]"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/", "Pi"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"out", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DomainIntegrate", "[", 
               RowBox[{"RHSolved", "[", "rhp1", "]"}], "]"}], " ", 
              RowBox[{"If", "[", 
               RowBox[{"scale", ",", 
                RowBox[{"1", "/", 
                 RowBox[{"Sqrt", "[", "t", "]"}]}], ",", "1"}], "]"}]}], 
             ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/", "Pi"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"timestring", "=", " ", 
       RowBox[{"\"\<Region: \>\"", " ", "<>", 
        RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\< (\>\"", "<>", 
        RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"ToString", "[", "t", "]"}], "<>", "\"\<) \>\"", "<>", 
        "\"\<1) Construct: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t1", "//", "First"}], "]"}], "<>", "\"\<  \>\"", "<>", 
        "\"\<1) Solve: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t2", "//", "First"}], "]"}], "<>", "\"\<  \>\"", "<>", 
        "\"\<2) Construct: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t3", "//", "First"}], "]"}], "<>", "\"\<  \>\"", "<>", 
        "\"\<2) Solve: \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"t4", "//", "First"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"timeflag", ",", 
        RowBox[{
         RowBox[{"Print", "[", "timestring", "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "out", ",", "\[CapitalPhi]", ",", "rhp1", ",", "rhp2", ",", 
        "timestring"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NLSAuto", "[", 
   RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"\[Piecewise]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"NLS", "[", "0", "]"}], "[", 
        RowBox[{"x", ",", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "x", "]"}], "<", "1"}], "&&", 
       RowBox[{"t", "<", ".1"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"NLS", "[", "1", "]"}], "[", 
        RowBox[{"x", ",", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"t", ">", "tcrit"}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"NLS", "[", "1", "]"}], "[", 
        RowBox[{"x", ",", "t"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "True"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.84]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, 
      "RowsIndexed" -> {}}]}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5656331021261997`*^9, 3.5656331507042*^9}, {
   3.5656332214231997`*^9, 3.5656332560642*^9}, {3.5656333681882*^9, 
   3.5656335261731997`*^9}, {3.5656335846042*^9, 3.5656335872632*^9}, {
   3.5656336435452003`*^9, 3.5656336860112*^9}, {3.5656338535052*^9, 
   3.5656338537632*^9}, {3.5656339276542*^9, 3.5656339286672*^9}, {
   3.5656592020192003`*^9, 3.5656592088892*^9}, {3.5656598958532*^9, 
   3.5656598966331997`*^9}, {3.5656619660292*^9, 3.5656620028492002`*^9}, 
   3.5656620931552*^9, {3.5656622786682*^9, 3.5656622915782003`*^9}, {
   3.5656634907882*^9, 3.5656635025982*^9}, {3.5656638034382*^9, 
   3.5656638245382*^9}, {3.5656644434452*^9, 3.5656644476521997`*^9}, {
   3.5656646513442*^9, 3.5656646589042*^9}, {3.5657047691472*^9, 
   3.5657047774302*^9}, {3.5657088696521997`*^9, 3.5657088700362*^9}, {
   3.5657089777462*^9, 3.5657090848772*^9}, {3.5657091151042*^9, 
   3.5657094998262*^9}, {3.5657095724021997`*^9, 3.5657095743862*^9}, {
   3.5657097344792*^9, 3.5657099280262003`*^9}, {3.5657109429972*^9, 
   3.5657110409142*^9}, {3.5657116229172*^9, 3.5657116266252003`*^9}, {
   3.5657271296342*^9, 3.5657272376172*^9}, {3.5657272685972*^9, 
   3.5657274588002*^9}, {3.5657275441552*^9, 3.5657275569462*^9}, {
   3.5657276169692*^9, 3.5657277268622*^9}, {3.5657277573022003`*^9, 
   3.5657277899292*^9}, {3.5657278648361998`*^9, 3.5657278652111998`*^9}, {
   3.5657279281822*^9, 3.5657280276302*^9}, 3.5657280680662003`*^9, {
   3.5657288935922003`*^9, 3.5657289195042*^9}, {3.5657303695222*^9, 
   3.5657304360642*^9}, {3.5657305933142*^9, 3.5657306444212*^9}, {
   3.565737475873736*^9, 3.5657374771709967`*^9}, {3.5657470873494787`*^9, 
   3.565747115534953*^9}, {3.5657549388660297`*^9, 3.565754942524865*^9}, {
   3.565754991522559*^9, 3.565754996829166*^9}, {3.5657555443336363`*^9, 
   3.5657555447033873`*^9}, {3.565797002050454*^9, 3.565797002546124*^9}, {
   3.5658025961582413`*^9, 3.565802605219771*^9}, {3.568778329962172*^9, 
   3.56877833620391*^9}, {3.568778439786294*^9, 3.568778445013896*^9}, {
   3.5687785062186613`*^9, 3.568778520944726*^9}, {3.568778613432576*^9, 
   3.5687786221517963`*^9}, {3.568779193115464*^9, 3.568779202270108*^9}, {
   3.568779347425478*^9, 3.568779347730536*^9}, {3.796498821989519*^9, 
   3.7964988406656256`*^9}, {3.7965192348156767`*^9, 
   3.7965192350121517`*^9}, {3.7983064848187823`*^9, 
   3.7983064865566473`*^9}, {3.7983347268856993`*^9, 3.798334728183779*^9}, {
   3.8201756199524007`*^9, 3.8201756201916714`*^9}, {3.82068883642556*^9, 
   3.8206888851681323`*^9}, 3.8206891474558926`*^9, {3.8207018415589848`*^9, 
   3.8207018620657763`*^9}, {3.820711859731616*^9, 3.8207118803702445`*^9}, {
   3.820711911451269*^9, 3.82071193408798*^9}, {3.8207121214907303`*^9, 
   3.8207121504656153`*^9}, {3.8214079151851463`*^9, 
   3.8214079263633866`*^9}, {3.824321398543126*^9, 3.8243214758147087`*^9}, {
   3.8243230704893403`*^9, 3.824323073114846*^9}, {3.8243234716524363`*^9, 
   3.8243234728138237`*^9}, {3.8243242755697327`*^9, 3.824324337720998*^9}, {
   3.8243243775367956`*^9, 3.824324378074028*^9}, {3.825524155578164*^9, 
   3.8255241855297756`*^9}, 3.825527758756492*^9, 
   3.825531577887506*^9},ExpressionUUID->"88f06f52-dbf6-41cd-873c-\
00e81ba6ac01"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"NLS", "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"DomainIntegrate", "[", 
         RowBox[{"RHSolveTop", "[", 
          RowBox[{"JNLS", "[", 
           RowBox[{"x", ",", "t"}], "]"}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "/", 
      RowBox[{"(", " ", "\[Pi]", "\[NonBreakingSpace]", ")"}]}], "*", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", ">", "tcrit"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "t", "]"}]}], ",", "1"}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NLSSelect", "[", "i_", "]"}], "[", 
     RowBox[{"x_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"DomainIntegrate", "[", 
         RowBox[{"RHSolveTop", "[", 
          RowBox[{
           RowBox[{"G", "[", "i", "]"}], "[", 
           RowBox[{"x", ",", "t"}], "]"}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "/", 
      RowBox[{"(", " ", "\[Pi]", "\[NonBreakingSpace]", ")"}]}], "*", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[Equal]", "2"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", "t", "]"}]}], ",", "1"}], "]"}]}]}], ";"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5656344982122*^9, 3.5656345131792*^9}, {
   3.5656346663412*^9, 3.5656346798782*^9}, 3.5656347371862*^9, {
   3.5656361196472*^9, 3.5656361466612*^9}, {3.5656363575992002`*^9, 
   3.5656363579532003`*^9}, {3.5656363913002*^9, 3.5656363914882*^9}, {
   3.5656364453812*^9, 3.5656364470552*^9}, {3.5656364934222*^9, 
   3.5656364977332*^9}, 
   3.5657096816722*^9},ExpressionUUID->"6dbc81b1-1223-4343-a9dd-1ec70e1d9e18"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.5463644907164*^9, 
  3.5463644913004*^9}},ExpressionUUID->"1f656c0c-1937-4f04-aa80-3c2a8c4ad66e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5463644931024*^9, 
  3.5463644945224*^9}},ExpressionUUID->"fa798e19-9536-4830-a5e0-ad04d203303e"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{769, 944},
WindowMargins->{{Automatic, -12}, {-11, Automatic}},
Magnification:>0.9 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 465, 10, 45, "Input",ExpressionUUID->"44ac4397-fe58-4aea-93eb-f060a41b809a"],
Cell[CellGroupData[{
Cell[1035, 34, 183, 3, 60, "Section",ExpressionUUID->"8931ef81-d18b-4dca-9d3a-67580819adfe",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1243, 41, 10599, 188, 1535, "Input",ExpressionUUID->"a6e7b6bd-3601-4fa9-985f-a9141df366d0",
 InitializationCell->True],
Cell[11845, 231, 1189, 17, 427, "Output",ExpressionUUID->"461303ec-3d51-4221-904b-01ac16eba5c0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13083, 254, 222, 5, 60, "Section",ExpressionUUID->"01de002d-1954-4c3e-935d-772c05829c6e",
 InitializationCell->True],
Cell[13308, 261, 13102, 304, 1031, "Input",ExpressionUUID->"96f36c45-5d8a-4e1c-8c5b-cd65f33b89f8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[26447, 570, 233, 4, 60, "Section",ExpressionUUID->"2e13379f-2867-4035-abed-dbe0815ed025"],
Cell[CellGroupData[{
Cell[26705, 578, 193, 4, 48, "Subsection",ExpressionUUID->"139cb498-2fbf-4518-ba09-c46f82d0867a",
 InitializationCell->True],
Cell[26901, 584, 669, 16, 45, "Input",ExpressionUUID->"834a6670-25e9-4883-b422-d9dcf7e28f8f"],
Cell[27573, 602, 32404, 873, 1785, "Input",ExpressionUUID->"8ce9026c-d6d0-4583-bd05-de48a65fd073",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[60014, 1480, 256, 5, 48, "Subsection",ExpressionUUID->"1d4e4dee-f44e-4218-9fab-f154865fb4c4",
 InitializationGroup->True],
Cell[60273, 1487, 26179, 837, 2002, "Input",ExpressionUUID->"2e54bda2-6944-4885-ba6c-9b8d4650221f",
 InitializationCell->True,
 InitializationGroup->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86501, 2330, 239, 5, 60, "Section",ExpressionUUID->"4c7bd190-ecff-4a61-8106-85c263634b1b",
 InitializationCell->True],
Cell[86743, 2337, 253, 6, 26, "Input",ExpressionUUID->"eda5d0fa-84d0-47fc-bac4-d7cbb46be5c3"],
Cell[86999, 2345, 18443, 466, 1211, "Input",ExpressionUUID->"39526c4e-cc3c-4f36-bf04-d47a659c1709",
 InitializationCell->True],
Cell[105445, 2813, 13659, 355, 869, "Input",ExpressionUUID->"ff5ac093-7774-42a1-a671-8be13dbdc55f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[119141, 3173, 260, 5, 60, "Section",ExpressionUUID->"e247ff98-4ffb-44eb-9a90-68cf27800d10",
 InitializationCell->True],
Cell[119404, 3180, 10446, 212, 509, "Input",ExpressionUUID->"86b6bc4e-c883-4652-a18b-3667d129609b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[129887, 3397, 257, 4, 60, "Section",ExpressionUUID->"c7d69baa-297b-4b74-bcea-c731d1cead62",
 InitializationCell->True],
Cell[130147, 3403, 4953, 138, 185, "Input",ExpressionUUID->"d9011f29-c848-439c-b2dd-6acbb306ff66",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[135137, 3546, 350, 6, 60, "Section",ExpressionUUID->"47a70790-9558-485d-b4bd-7433058c7e36",
 InitializationCell->True],
Cell[135490, 3554, 12360, 378, 603, "Input",ExpressionUUID->"d56e2b23-4347-4a4a-9845-0af06ed4d559",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[147887, 3937, 319, 8, 94, "Section",ExpressionUUID->"e524acd8-237f-48a9-b708-fa6781d643b5",
 InitializationCell->True],
Cell[148209, 3947, 4445, 124, 203, "Input",ExpressionUUID->"5fae13f7-2710-4d45-8b50-ba6de950f5f4",
 InitializationCell->True],
Cell[152657, 4073, 4478, 127, 167, "Input",ExpressionUUID->"f4e2ba9e-b4af-48be-9ac8-07235bc0bdf3",
 InitializationCell->True],
Cell[157138, 4202, 19098, 489, 599, "Input",ExpressionUUID->"b8c6031a-b82b-4f28-92b9-f4d91bc4d5c0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[176273, 4696, 240, 5, 60, "Section",ExpressionUUID->"2533f437-0781-45be-86b6-0a7c08935c96",
 InitializationCell->True],
Cell[176516, 4703, 45429, 1190, 2020, "Input",ExpressionUUID->"f195008e-39ec-4f4c-a3d8-3c85cfc3acaf",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[221982, 5898, 313, 8, 75, "Section",ExpressionUUID->"16016f48-5b4a-49fb-908f-f42f9f62211d",
 InitializationCell->True],
Cell[222298, 5908, 9516, 273, 297, "Input",ExpressionUUID->"453ca672-a7ed-4b51-a2bc-7e1fc02680d9",
 InitializationCell->True],
Cell[231817, 6183, 21546, 485, 732, "Input",ExpressionUUID->"1b401ad1-8983-40dc-a9f4-da1ab5e5f04f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[253400, 6673, 241, 5, 48, "Section",ExpressionUUID->"2b3edd14-5242-423f-bdd6-dd70b29ae6d2",
 InitializationCell->True],
Cell[253644, 6680, 13470, 307, 663, "Input",ExpressionUUID->"88f06f52-dbf6-41cd-873c-00e81ba6ac01",
 InitializationCell->True],
Cell[267117, 6989, 1906, 50, 62, "Input",ExpressionUUID->"6dbc81b1-1223-4343-a9dd-1ec70e1d9e18",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[269060, 7044, 172, 3, 48, "Section",ExpressionUUID->"1f656c0c-1937-4f04-aa80-3c2a8c4ad66e",
 InitializationCell->True],
Cell[269235, 7049, 216, 5, 32, "Input",ExpressionUUID->"fa798e19-9536-4830-a5e0-ad04d203303e",
 InitializationCell->True]
}, Open  ]]
}
]
*)

